{"version":3,"sources":["assets/magnifying-glass.svg","assets/pen.pencil.svg","webpack:///./src/App.scss?4040","App.tsx","app/connection.ts","app/reducers/chats.ts","app/reducers/connection.ts","app/reducers/contacts.ts","app/reducers/debug.ts","app/reducers/messages.ts","app/reducers/presence.ts","app/store.ts","app/typing-aggregator.ts","components/ChatSidebar.tsx","components/ChatSidebarItem.tsx","components/bar/ChatBar.tsx","components/bar/TranscriptBar.tsx","components/chat/ChatBubble.tsx","components/contacts/CNContactBubble.tsx","components/devtools/DevtoolsRoot.tsx","components/devtools/presentation/DebugBoolean.tsx","components/devtools/presentation/DebugDetails.tsx","components/devtools/sections/DebugSettings.tsx","components/devtools/sections/GroupSettings.tsx","components/devtools/sections/Settings.tsx","components/devtools/sections/Statistics.tsx","components/react-window-dynamic/DynamicSizeList.Foundation.tsx","components/react-window-dynamic/DynamicSizeList.tsx","components/transcript/ChatTranscript.tsx","components/transcript/ChatTranscriptFoundation.tsx","components/transcript/Recycler.tsx","components/transcript/acknowledgments/AcknowledgmentPicker.tsx","components/transcript/composition/Composition.tsx","components/transcript/composition/MCUtils.ts","components/transcript/composition/plugins/DragAndDrop.ts","components/transcript/composition/plugins/PlaceholderPlugin.ts","components/transcript/composition/schema.ts","components/transcript/composition/send-message.ts","components/transcript/items/IMChatItem.Foundation.ts","components/transcript/items/IMChatItem.tsx","components/transcript/items/IMTranscriptItem.tsx","components/transcript/items/Message.foundation.ts","components/transcript/items/Message.tsx","components/transcript/items/MessageReceiptController.tsx","components/transcript/items/chat/IMAttachmentChatItem.tsx","components/transcript/items/chat/IMPluginChatItem.tsx","components/transcript/items/chat/IMTextChatItem.tsx","components/transcript/items/chat/IMTypingChatItem.tsx","components/transcript/items/chat/plugin-renderers/LPBalloon.tsx","components/transcript/items/chat/plugin-renderers/MSMessageExtensionBalloonPlugin.tsx","components/transcript/items/chat/plugin-renderers/lp-support/LPAssetRenderer.tsx","components/transcript/items/chat/plugin-renderers/lp-support/LPCaptionBar.tsx","components/transcript/items/chat/plugin-renderers/lp-support/LPCaptionIcon.tsx","components/transcript/items/chat/plugin-renderers/lp-support/LPCaptionSection.tsx","components/transcript/items/chat/plugin-renderers/lp-support/LPMedia.tsx","components/transcript/items/transcript/IMDateSeparatorItem.tsx","components/transcript/items/transcript/IMGroupTitleChangeItem.tsx","components/transcript/items/transcript/IMParticipantChangeItem.tsx","contexts/ChatSearchContext.tsx","hooks/useChatName.ts","hooks/useContactResolver.ts","hooks/useEvent.ts","hooks/useFormattedHandles.ts","webpack:///./src/index.css?68b8","index.tsx","webpack:///./src/styles/ChatSidebar.scss?118b","webpack:///./src/styles/ChatSidebarItem.scss?b704","webpack:///./src/styles/ack-picker/AcknowledgmentPicker.scss?d403","webpack:///./src/styles/contacts/CNContactBubble.scss?9c67","webpack:///./src/styles/transcript/Composition.scss?bbc2","webpack:///./src/styles/transcript/items/IMChatItem.scss?1da2","webpack:///./src/styles/transcript/items/IMTranscriptItem.scss?07ab","webpack:///./src/styles/transcript/items/Message.scss?6297","util/dom.ts","util/log.ts","util/message-presentation.ts","util/receipt-formatting.ts","util/use-persistent.ts"],"names":["insertStyles","elm","document","getElementById","head","appendChild","createElement","id","textContent","map","apiClient","resourceURL","join","getResourceMode","then","mode","body","classList","add","App","showingDevtools","useSelector","selectShowingDevtools","isPrivacyMode","selectIsPrivacyMode","currentChatID","useCurrentChatID","useMemo","socketClient","connect","preload","undefined","didBootstrap","selectBootstrapState","toString","Log","IMMakeLog","imCoreHostConfig","getPersistentValue","formatURL","protocol","path","value","IMWebSocketClient","IMHTTPClient","baseURL","rebuildEndpoints","url","reconnect","options","close","receiveChangedChat","chat","store","dispatch","chatChanged","on","EventType","conversationCreated","conversationChanged","conversationRemoved","chatDeleted","conversationDisplayNameChanged","conversationJoinStateChanged","conversationPropertiesChanged","conf","chatPropertiesChanged","conversationUnreadCountChanged","participantsChanged","ev","chatParticipantsUpdated","receiveMessages","messages","debug","length","messagesChanged","chatMessagesReceived","TypingAggregator","sharedInstance","messagesReceived","receiveItems","items","filter","item","type","ChatItemType","message","payload","itemsReceived","itemsUpdated","itemsRemoved","messagesDeleted","itemStatusChanged","statusChanged","receiveContact","contact","contactChanged","contactCreated","contactUpdated","contactRemoved","c","contactDeleted","bootstrap","chats","contacts","info","chatsChanged","contactsChanged","strangersReceived","strangers","receivedBootstrap","initialState","byID","typingStatus","acceptedLastMessageTypes","acknowledgment","associated","plugin","sticker","attachment","text","chatSlice","createSlice","name","reducers","newChats","forEach","chatID","description","time","lastMessageTime","isTyping","some","typing","includes","Object","assign","lastMessage","setTypingStatus","properties","handles","participants","actions","selectChats","state","selectTypingStatus","reducer","bootstrapped","connectionSlice","connection","contactsSlice","newContacts","reduce","acc","contactID","stranger","selectContacts","selectStrangers","selectHandleIDToContact","createSelector","values","handle","persistentConfig","showDevtools","invertedScrolling","privacy","debugSlice","setShowDevtools","setPrivacyMode","setInvertedScrolling","selectUseInvertedScrolling","messageToChatID","messagesSlice","acknowledgments","messageStorage","associatedMessageID","push","sort","a1","a2","associatedID","split","messageID","associatedItem","find","messageItem","ack","fromMe","acknowledgmentType","messageIDs","stopTyping","timeDelivered","timePlayed","timeRead","console","log","stageAcknowledgmentOverride","chatItemID","oldFromMe","findIndex","splice","Date","now","selectMessages","tabIsActive","hoveringOverMessageID","hoveringOverChatItemID","hoveringOverChatID","presenceSlice","visibilityChanged","presence","isActive","visibilityState","messageChanged","chatItemChanged","endsWith","selectVisibilityState","selectHoveringOverMessageID","selectHoveringOverChatID","selectHoveringOverChatItemID","configureStore","chatReducer","messagesReducer","contactsReducer","presenceReducer","debugReducer","connectionReducer","middleware","getDefaultMiddleware","immutableCheck","isTypingMessage","Map","timeouts","oldMessage","typingMessageForChat","set","has","clearTimeout","get","setTimeout","delete","messageReceived","typingMessageID","getState","findChatID","element","findAncestor","ancestor","hasAttribute","getAttribute","RowRenderer","React","memo","index","data","style","prevProps","nextProps","areEqual","prevChat","nextChat","unreadMessageCount","displayName","ignoreAlerts","groupPhotoID","JSON","stringify","ChatSidebar","useContext","ChatSearchContext","chatResults","slice","c1","c2","event","target","HTMLElement","height","Math","random","useLastMessageTime","useFormattedReceipt","ChatSidebarItem","chatName","useChatName","currentChat","useCurrentChat","ChatBar","searchCriteria","setSearchCriteria","TranscriptBar","ChatStyle","DMBubble","props","useState","recipientID","setRecipientID","useEffect","useContactResolver","GroupChatBubble","lastTwoHandleIDs","setLastTwoHandleIDs","ChatBubble","group","backgroundImage","attachmentURL","CNContactBubble","backgroundPhotoURL","setBackgroundPhotoURL","contactInitials","setContactInitials","useLayoutEffect","hasPicture","contactPhotoURL","firstName","lastName","initials","toUpperCase","className","DevtoolsRoot","DebugBoolean","onInput","DebugDetails","details","DebugSettings","isPrivacy","newIsPrivacy","DraftInput","label","placeholder","commit","draft","setDraft","busy","setBusy","e","key","preventDefault","mergeClassName","className1","useBusyController","disabled","fn","canProceed","DebugCheckbox","changed","children","isDisabled","fire","checked","DebugButton","click","GroupSettings","readReceipts","patchProperties","readAllMessages","setTyping","deleteChat","DSLDebugTools","EventBus","emit","newGroupName","rename","participant","removeParticipants","shortHash","isScrollingInverted","usePersistent","imCoreHost","setIMCoreHost","isReconnecting","setIsReconnecting","initial","Statistics","loadedChats","loadedMessages","flatMap","record","useHoveredChatItem","hoveredChatItem","hoveredMessage","hoveredChat","useHoveredChat","service","sender","NaN","DynamicListContext","createContext","useInvertScrollDirection","enabled","ref","useRef","invertedWheelEvent","useCallback","current","scrollTop","deltaY","removeEventListener","repair","addEventListener","incomingRef","isMacOS","navigator","userAgent","toLowerCase","hostIsMacOS","RowMeasurer","width","memoState","setSize","rowRoot","observer","ResizeObserver","entry","contentRect","disconnect","observe","sizeStorage","DynamicSizeList","listRef","scrollWatcher","sizeMap","resetList","resetAfterIndex","size","from","to","nonce","useEvent","scrollTo","scrollOffset","itemData","scrollToItem","getSize","getID","calcEstimatedSize","keys","estimatedHeight","p","i","MemoizedRowMeasurer","createRendererProps","rowProps","listProps","Renderer","isSame","itemCount","overscanCount","nearEnd","overscanStartIndex","overscanStopIndex","itemKey","MemoLog","messagesAreRenderSame","prevMessage","nextMessage","itemsAreShallowEqual","compareMessageRenderProps","prevBeforeMessage","nextBeforeMessage","prevAfterMessage","nextAfterMessage","getLastReadAndDeliveredFromMe","lastDeliveredFromMe","lastReadFromMe","isDelivered","searchNodeForMessageRelations","node","next","parentNode","ChatTranscript","useCurrentMessages","loadMore","unreadCount","isVisible","processing","setIsProcessing","Node","reload","before","fetchRecentMessages","limit","recentMessages","isDoneLedger","loadingLedger","useMessages","reverse","injectTimestamps","allMessages","processedMessages","prepareMessagesForPresentation","lastMessageID","TIMESTAMP_ASSOCIATION","MessagesContext","ChatContext","useResolvedMessage","useHoveredMessage","hoveredChatItemID","CurrentChatProvider","useLocation","pathname","matchPath","params","CurrentMessagesProvider","RecycledElementRenderer","renderer","initializer","destructor","cache","context","el","temp","replaceWith","itemIsAcknowledgable","AcknowledgmentName","AcknowledgmentButton","ackFromMe","chatItem","isSelected","sendType","createAssociatedMessage","ackMessage","AcknowledgmentPicker","extractAcknowledgments","heart","AcknowledgmentType","thumbsUp","thumbsup","thumbsDown","thumbsdown","haha","ha","emphasize","exclamation","question","questionmark","IMTypingLedger","fireSendMessage","sendMessage","doc","transaction","tr","content","apply","Composition","placeholderPlugin","makePlaceholderPlugin","dragAndDropPlugin","makeDragAndDropPlugin","IMProseSchema","editorView","setEditorView","canSend","setCanSend","useProseMirror","schema","plugins","Plugin","_","__","___","newState","isEmpty","documentIsEmpty","catch","init","keymap","splitBlock","baseKeymap","setState","editorViewHandle","view","dom","newEditorView","updateEditorClass","toggle","flatDescendants","descendants","everyDescendant","check","every","nodeOnlyContainsText","isText","isTextblock","replaceDOMPRNode","domNode","prNode","prosePos","posAtDOM","setSelection","NodeSelection","create","deleteSelection","insert","replaceDOMIDPRNode","domID","readFile","file","reader","FileReader","pending","Promise","resolve","result","readAsDataURL","getVideoCover","reject","player","setAttribute","URL","createObjectURL","load","ex","error","currentTime","canvas","videoWidth","videoHeight","ctx","getContext","drawImage","toBlob","blob","getFileImage","startsWith","cover","IMFileCache","IMImageBase64Cache","IMFileUploadCache","uploadFileWithID","Error","attachments","mime","filename","elementForFileWithID","isImage","isVideo","baseProps","class","src","handleDOMEvents","drop","files","dataTransfer","selection","makeUUID","$from","pos","nodes","attachmentID","resolved","scrollIntoView","decorations","decorate","isBlock","childCount","Decoration","nodeSize","DecorationSet","_specNodes","spec","Schema","paragraph","inline","attrs","default","draggable","parseDOM","tag","getAttrs","toDOM","rawParts","partWithPos","part","textChunks","parent","childAfter","nextNode","nextPos","partPos","associatedPart","all","compiled","p1","p2","parts","ack1","ack2","emojiCount","str","joiner","count","s","num","Array","regex","createRegex","IMTextChatItemIsJumbo","replace","IMItemIsJumbo","subject","chatItemComponentForItem","IMTextChatItem","IMAttachmentChatItem","IMPluginChatItem","IMTypingChatItem","isChatItem","IMChatItem","fallback","Component","isJumbo","a","DATE_SEPARATOR_TYPE","Symbol","transcriptTypes","date","participantChange","groupAction","groupTitle","itemIsTranscriptLike","componentForItem","IMGroupTitleChangeItem","IMParticipantChangeItem","IMDateSeparatorItem","isTranscriptItem","IMTranscriptItem","useFormattedTimestamp","allItemsAreChatItems","message1","message2","items1","items2","item1","item2","innerAck1","innerAck2","messagesAreContiguous","abs","analyzeMessage","beginningContiguous","endingContiguous","showImage","showName","messageIsEmpty","useContact","useMessageSenderName","fullName","formatPhoneNumber","Message","eRef","messageSenderContact","messageIsTranscriptMessage","nextIsTranscript","prevIsTranscript","senderName","showReceipt","solo","readReceiptTransitionManager","useEffectAfterFirstRun","effect","deps","isFirstRun","MessageReceiptController","formattedReceipt","isComplete","setIsComplete","isTransitioning","setIsTransitioning","isAppearing","setIsAppearing","isDisappearing","setIsDisappearing","IMAttachmentRenderingFormat","ERComputeRenderingFormat","metadata","substring","image","video","IMImageAttachmentRenderer","alt","IMVideoAttachmentRenderer","controls","IMRenderingImplementation","transferID","RenderingImplementation","prevItem","newItem","bundleID","richLink","LPBalloon","MSMessageExtensionBalloonPlugin","warn","IMTextPartFormattingDirective","ERExtractFormattingDirectivesForIMTextPart","directives","Set","attributes","attr","TextPartAttributeType","bold","mention","writingDirection","TextPartType","calendar","underline","IMTextPartAttributeFormatter","additionalDirectives","concat","string","IMTextLinkPart","componentForPart","link","makeRGBA","color","red","green","blue","alpha","backgroundRGBA","backgroundColor","Element","background","audio","mediaTopCaptionBar","mediaBottomCpationBar","quotedText","captionBar","makeText","textScale","generateCaptionBar","caption","subcaption","secondarySubcaption","tertiarySubcaption","top","leading","trailing","bottom","generateMediaBottomCaptionBar","imageTitle","imageSubtitle","generateMediaTopCaptionBar","appIcon","leadingIcon","generateRichLink","layoutInfo","appName","attachmentIndex","extension","LPAssetRenderer","videoURL","imageURL","poster","LPCaptionBar","aboveTop","belowBottom","trailingIcon","isSyntheticImage","icon","computeIconSrc","LPCaptionIcon","position","LPCaptionSection","section","asset","LPMedia","streamingURL","youTubeURL","topCaptionBar","bottomCaptionBar","formattedSender","useFormattedHandle","title","formattedInitiator","initiatorID","formattedTarget","targetID","changeType","clearSearchCriteria","ChatSearchProvider","allChats","flat","handleIDToContact","extractFormattedHandles","handleIDs","setResolved","handleID","EventEmitter","off","rawPhoneNumber","phoneNumber","parsePhoneNumber","countryCallingCode","formatNational","useFormattedHandles","ReactDOM","render","cb","parentElement","sharedStream","ConsoleFormattedStream","makeMaybeLogger","logger","configLevel","requiredLevel","namespace","level","createLogger","stream","resolvedLevel","resolveLevel","maybeDebug","IMLog","messagesAreCloseEnough","createTimestampMessage","isSOS","isAudioMessage","isCancelTypingMessage","fileTransferIDs","flags","preparedMessages","m1","m2","millis","setFormattedReceipt","parsed","DateTime","fromMillis","hasSame","local","toLocaleString","TIME_SIMPLE","minus","day","toRelativeCalendar","DATE_SHORT","formattedTimestamp","setFormattedTimestamp","persistentCache","persistentObservers","read","defaultValue","localStorage","getItem","parse","versionedValueFactory","Proxy","revision","observePersistent","property","setItem","persistentValue","setPersistentValue","latest","newValue"],"mappings":"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","file":"static/js/main.bf3f76d6.chunk.js","sourcesContent":["var _g;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgMagnifyingGlass(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"hpIconSymbol\",\n    viewBox: \"4.94140625 4.640625 40.283203125 40.6484375\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _g || (_g = /*#__PURE__*/React.createElement(\"g\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    fillRule: \"nonzero\",\n    transform: \"scale(1,-1) translate(0,-49.951171875)\"\n  }, /*#__PURE__*/React.createElement(\"path\", {\n    fillOpacity: 1,\n    d: \"     M 20.689453125,13.79296875     C 24.53515625,13.79296875 28.05859375,15.189453125 30.787109375,17.48828125     L 43.205078125,5.005859375     C 43.3984375,4.833984375 43.677734375,4.662109375 44.0,4.662109375     C 44.794921875,4.662109375 45.224609375,5.263671875 45.224609375,5.88671875     C 45.224609375,6.166015625 45.1171875,6.4453125 44.880859375,6.681640625     L 32.462890625,19.12109375     C 34.93359375,21.892578125 36.458984375,25.56640625 36.458984375,29.541015625     C 36.458984375,38.19921875 29.34765625,45.310546875 20.689453125,45.310546875     C 12.03125,45.310546875 4.94140625,38.19921875 4.94140625,29.541015625     C 4.94140625,20.8828125 12.03125,13.79296875 20.689453125,13.79296875     Z     M 20.689453125,14.845703125     C 12.611328125,14.845703125 5.994140625,21.462890625 5.994140625,29.541015625     C 5.994140625,37.619140625 12.611328125,44.2578125 20.689453125,44.2578125     C 28.767578125,44.2578125 35.40625,37.619140625 35.40625,29.541015625     C 35.40625,21.462890625 28.767578125,14.845703125 20.689453125,14.845703125     Z \"\n  }))));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgMagnifyingGlass);\nexport default __webpack_public_path__ + \"static/media/magnifying-glass.8d940112.svg\";\nexport { ForwardRef as ReactComponent };","var _path;\n\nfunction _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\nimport * as React from \"react\";\n\nfunction SvgPenpencil(_ref, svgRef) {\n  var title = _ref.title,\n      titleId = _ref.titleId,\n      props = _objectWithoutProperties(_ref, [\"title\", \"titleId\"]);\n\n  return /*#__PURE__*/React.createElement(\"svg\", _extends({\n    id: \"hpIconSymbol\",\n    viewBox: \"0 0 56 56\",\n    ref: svgRef,\n    \"aria-labelledby\": titleId\n  }, props), title ? /*#__PURE__*/React.createElement(\"title\", {\n    id: titleId\n  }, title) : null, _path || (_path = /*#__PURE__*/React.createElement(\"path\", {\n    xmlns: \"http://www.w3.org/2000/svg\",\n    d: \"M 48.7772 9.9766 L 50.4649 8.2422 C 51.2852 7.4219 51.2852 6.2734 50.4880 5.5000 L 49.9489 4.9375 C 49.2227 4.2109 48.0740 4.3047 47.3008 5.0547 L 45.5897 6.7422 Z M 21.8007 34.3516 L 26.3710 32.3594 L 47.0665 11.6875 L 43.8554 8.5234 L 23.1835 29.1953 L 21.0741 33.6016 C 20.8866 34.0000 21.3554 34.5391 21.8007 34.3516 Z M 12.0741 51.7891 L 39.5897 51.7891 C 43.8085 51.7891 46.2460 49.3516 46.2460 44.5234 L 46.2460 18.4375 L 42.4726 22.2109 L 42.4726 44.3360 C 42.4726 46.7734 41.1601 48.0156 39.5429 48.0156 L 12.1444 48.0156 C 9.8007 48.0156 8.4882 46.7734 8.4882 44.3360 L 8.4882 17.7344 C 8.4882 15.2969 9.8007 14.0312 12.1444 14.0312 L 32.4179 14.0312 L 36.1913 10.2578 L 12.0741 10.2578 C 7.1992 10.2578 4.7148 12.6953 4.7148 17.5234 L 4.7148 44.5234 C 4.7148 49.3750 7.1992 51.7891 12.0741 51.7891 Z\"\n  })));\n}\n\nvar ForwardRef = /*#__PURE__*/React.forwardRef(SvgPenpencil);\nexport default __webpack_public_path__ + \"static/media/pen.pencil.b8c4d966.svg\";\nexport { ForwardRef as ReactComponent };","// extracted by mini-css-extract-plugin","import React, { useMemo } from \"react\";\r\nimport { useSelector } from \"react-redux\";\r\nimport \"./App.scss\";\r\nimport { apiClient, socketClient } from \"./app/connection\";\r\nimport { selectBootstrapState } from \"./app/reducers/connection\";\r\nimport { selectIsPrivacyMode, selectShowingDevtools } from \"./app/reducers/debug\";\r\nimport ChatBar from \"./components/bar/ChatBar\";\r\nimport TranscriptBar from \"./components/bar/TranscriptBar\";\r\nimport ChatSidebar from \"./components/ChatSidebar\";\r\nimport DevtoolsRoot from \"./components/devtools/DevtoolsRoot\";\r\nimport ChatTranscript from \"./components/transcript/ChatTranscript\";\r\nimport { CurrentMessagesProvider, useCurrentChatID } from \"./components/transcript/ChatTranscriptFoundation\";\r\nimport { ChatSearchProvider } from \"./contexts/ChatSearchContext\";\r\n\r\nfunction insertStyles() {\r\n  const elm = document.getElementById(\"generated-styles\") || document.head.appendChild(document.createElement(\"style\"));\r\n  elm.id = \"generated-resources\";\r\n  elm.textContent = `:root {\r\n    ${[\r\n      \"bubble-tail\", \"bubble-notail\", \"bubble-stroke-tail\", \"bubble-stroke-notail\", \"send-button\", \"ack-bubble\", \"ack-double-bubble\", \"ack-middle\", \"ack-stack\", \"ack-heart\", \"ack-thumbs-up\", \"ack-thumbs-down\", \"ack-emphasize\", \"ack-question\", \"ack-haha-ar\", \"ack-haha-el\", \"ack-haha-en\", \"ack-haha-es\", \"ack-haha-he\", \"ack-haha-hi\", \"ack-haha-it\", \"ack-haha-ja\", \"ack-haha-ko\", \"ack-haha-th\", \"ack-haha-zh\", \"replay\", \"icloud\", \"video-play\", \"recorded-audio-template\"\r\n    ].map(id => `--${id}-url:url(${apiClient.resourceURL(id)});--${id}-flip-url:url(${apiClient.resourceURL(id)}?flip=1);`).join(\"\\n\")}\r\n  }`;\r\n}\r\n\r\ninsertStyles();\r\n\r\napiClient.getResourceMode().then(mode => document.body.classList.add(mode));\r\n\r\nfunction App() {\r\n  const showingDevtools = useSelector(selectShowingDevtools);\r\n  const isPrivacyMode = useSelector(selectIsPrivacyMode);\r\n  const currentChatID = useCurrentChatID();\r\n\r\n  useMemo(() => {\r\n    socketClient.connect(currentChatID ? { preload: currentChatID } : undefined);\r\n  }, []);\r\n\r\n  const didBootstrap = useSelector(selectBootstrapState);\r\n\r\n  return (\r\n      <div className=\"app-root\" attr-showing-devtools={showingDevtools.toString()} attr-privacy-mode={isPrivacyMode.toString()}>\r\n          <ChatSearchProvider>\r\n            <div className=\"app-bar\">\r\n              <ChatBar />\r\n              <TranscriptBar />\r\n            </div>\r\n            <ChatSidebar />\r\n            {\r\n              didBootstrap ? (\r\n                <CurrentMessagesProvider>\r\n                  <ChatTranscript />\r\n                </CurrentMessagesProvider>\r\n              ) : (\r\n                <ChatTranscript />\r\n              )\r\n            }\r\n            {\r\n              showingDevtools ? (\r\n                <DevtoolsRoot />\r\n              ) : null\r\n            }\r\n          </ChatSearchProvider>\r\n      </div>\r\n  );\r\n}\r\n\r\nexport default App;\r\n","import { AnyChatItemModel, ChatItemType, ChatRepresentation, ContactRepresentation, EventType, IMHTTPClient, IMWebSocketClient, IMWebSocketConnectionOptions, MessageRepresentation } from \"imcore-ajax-core\";\nimport IMMakeLog from \"../util/log\";\nimport { getPersistentValue } from \"../util/use-persistent\";\nimport { chatChanged, chatDeleted, chatMessagesReceived, chatParticipantsUpdated, chatPropertiesChanged, chatsChanged } from \"./reducers/chats\";\nimport { receivedBootstrap } from \"./reducers/connection\";\nimport { contactChanged, contactDeleted, contactsChanged, strangersReceived } from \"./reducers/contacts\";\nimport { messagesChanged, messagesDeleted, statusChanged } from \"./reducers/messages\";\nimport { store } from \"./store\";\nimport TypingAggregator from \"./typing-aggregator\";\n\nconst Log = IMMakeLog(\"IMServerConnection\", \"info\");\n\nconst imCoreHostConfig = getPersistentValue<string>(\"imcore-host\", \"localhost:8090\");\n\nconst formatURL = (protocol: string, path?: string) => `${protocol}://${imCoreHostConfig.value}${path ? `/${path}` : \"\"}`;\n\nexport const socketClient = new IMWebSocketClient(formatURL(\"ws\", \"stream\"));\nexport const apiClient = new IMHTTPClient({\n    baseURL: formatURL(\"http\")\n});\n\nfunction rebuildEndpoints() {\n    socketClient.url = formatURL(\"ws\", \"stream\");\n    apiClient.baseURL = formatURL(\"http\");\n}\n\nexport async function reconnect(options?: IMWebSocketConnectionOptions): Promise<void> {\n    await socketClient.close();\n    rebuildEndpoints();\n    socketClient.connect(options);\n}\n\nfunction receiveChangedChat(chat: ChatRepresentation) {\n    store.dispatch(chatChanged(chat));\n}\n\nsocketClient.on(EventType.conversationCreated, receiveChangedChat);\nsocketClient.on(EventType.conversationChanged, receiveChangedChat);\nsocketClient.on(EventType.conversationRemoved, ({ chat }) => store.dispatch(chatDeleted(chat)));\nsocketClient.on(EventType.conversationDisplayNameChanged, receiveChangedChat);\nsocketClient.on(EventType.conversationJoinStateChanged, receiveChangedChat);\nsocketClient.on(EventType.conversationPropertiesChanged, conf => store.dispatch(chatPropertiesChanged(conf)));\nsocketClient.on(EventType.conversationUnreadCountChanged, receiveChangedChat);\nsocketClient.on(EventType.participantsChanged, ev => store.dispatch(chatParticipantsUpdated(ev)));\n\nexport function receiveMessages(messages: MessageRepresentation[]) {\n    Log.debug(\"Received %d messages from server\", messages.length);\n\n    store.dispatch(messagesChanged(messages));\n    store.dispatch(chatMessagesReceived(messages));\n    TypingAggregator.sharedInstance.messagesReceived(messages);\n}\n\nexport function receiveItems(items: AnyChatItemModel[]) {\n    const messages: MessageRepresentation[] = items.filter(item => item.type === ChatItemType.message).map(item => item.payload) as MessageRepresentation[];\n\n    receiveMessages(messages);\n}\n\nsocketClient.on(EventType.itemsReceived, ({ items }) => receiveItems(items));\nsocketClient.on(EventType.itemsUpdated, ({ items }) => receiveItems(items));\nsocketClient.on(EventType.itemsRemoved, ({ messages }) => store.dispatch(messagesDeleted(messages)));\n\nsocketClient.on(EventType.itemStatusChanged, payload => store.dispatch(statusChanged(payload)));\n\nfunction receiveContact(contact: ContactRepresentation) {\n    store.dispatch(contactChanged(contact));\n}\n\nsocketClient.on(EventType.contactCreated, receiveContact);\nsocketClient.on(EventType.contactUpdated, receiveContact);\nsocketClient.on(EventType.contactRemoved, c => store.dispatch(contactDeleted(c.id)));\n\nsocketClient.on(EventType.bootstrap, ({ chats, contacts, messages }) => {\n    Log.info(\"Got bootstrap from event stream\");\n    store.dispatch(chatsChanged(chats));\n    store.dispatch(contactsChanged(contacts.contacts));\n    store.dispatch(strangersReceived(contacts.strangers));\n    if (messages) receiveMessages(messages);\n\n    store.dispatch(receivedBootstrap());\n});","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { ChatConfigurationRepresentation, ChatItemType, ChatRepresentation, MessageRepresentation, ParticipantsChangedEvent } from \"imcore-ajax-core\";\nimport { RootState } from \"../store\";\n\ninterface ChatState {\n    byID: Record<string, ChatRepresentation>;\n    typingStatus: Record<string, boolean>;\n}\n\nconst initialState: ChatState = {\n    byID: {},\n    typingStatus: {}\n};\n\nconst acceptedLastMessageTypes = [\n    ChatItemType.acknowledgment,\n    ChatItemType.associated,\n    ChatItemType.plugin,\n    ChatItemType.sticker,\n    ChatItemType.attachment,\n    ChatItemType.text\n];\n\nexport const chatSlice = createSlice({\n    name: \"chats\",\n    initialState,\n    reducers: {\n        chatsChanged: (chats, { payload: newChats }: PayloadAction<ChatRepresentation[]>) => {\n            newChats.forEach(chat => chats.byID[chat.id] = chat);\n        },\n        chatChanged: (chats, { payload: chat }: PayloadAction<ChatRepresentation>) => {\n            chats.byID[chat.id] = chat;\n        },\n        chatDeleted: (chats, { payload: chatID }: PayloadAction<string>) => {\n            delete chats.byID[chatID];\n        },\n        chatMessagesReceived: (chats, { payload: messages }: PayloadAction<MessageRepresentation[]>) => {\n            for (const { chatID, description, time, items } of messages) {\n                if (!chats.byID[chatID]) continue;\n                if (time <= chats.byID[chatID].lastMessageTime) continue;\n\n                const isTyping = items.some(item => item.type === ChatItemType.typing);\n\n                chats.typingStatus[chatID] = isTyping;\n\n                if (!items.some(item => acceptedLastMessageTypes.includes(item.type))) continue;\n\n                Object.assign(chats.byID[chatID], {\n                    lastMessage: description,\n                    lastMessageTime: time\n                } as Partial<ChatRepresentation>);\n            }\n        },\n        setTypingStatus: (chats, { payload: { chatID, typing } }: PayloadAction<{ chatID: string; typing: boolean; }>) => {\n            chats.typingStatus[chatID] = typing;\n        },\n        chatPropertiesChanged: (chats, { payload: { id, ...properties } }: PayloadAction<ChatConfigurationRepresentation>) => {\n            if (!chats.byID[id]) return;\n\n            Object.assign(chats.byID[id], properties);\n        },\n        chatParticipantsUpdated: (chats, { payload: { chat, handles } }: PayloadAction<ParticipantsChangedEvent>) => {\n            if (!chats.byID[chat]) return;\n\n            chats.byID[chat].participants = handles;\n        }\n    }\n});\n\nexport const { chatsChanged, setTypingStatus, chatChanged, chatDeleted, chatMessagesReceived, chatPropertiesChanged, chatParticipantsUpdated } = chatSlice.actions;\n\nexport const selectChats = (state: RootState) => state.chats.byID;\nexport const selectTypingStatus = (state: RootState, chatID: string) => state.chats.typingStatus[chatID] || false;\n\nexport default chatSlice.reducer;","import { createSlice } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\n\ninterface ConnectionState {\n    bootstrapped: boolean;\n}\n\nconst initialState: ConnectionState = {\n    bootstrapped: false\n};\n\nexport const connectionSlice = createSlice({\n    name: \"connection\",\n    initialState,\n    reducers: {\n        receivedBootstrap: (connection) => {\n            connection.bootstrapped = true;\n        }\n    }\n});\n\nexport const { receivedBootstrap } = connectionSlice.actions;\n\nexport const selectBootstrapState = (state: RootState) => state.connection.bootstrapped;\n\nexport default connectionSlice.reducer;","import { createSelector, createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { ContactRepresentation, HandleRepresentation } from \"imcore-ajax-core\";\nimport { RootState } from \"../store\";\n\ninterface ContactsState {\n    byID: Record<string, ContactRepresentation>;\n    strangers: Record<string, HandleRepresentation>;\n}\n\nconst initialState: ContactsState = {\n    byID: {},\n    strangers: {}\n};\n\nexport const contactsSlice = createSlice({\n    name: \"contacts\",\n    initialState,\n    reducers: {\n        contactsChanged: (contacts, { payload: newContacts }: PayloadAction<ContactRepresentation[]>) => {\n            Object.assign(contacts.byID, newContacts.reduce((acc, contact) => Object.assign(acc, {\n                [contact.id]: contact\n            }), {}));\n        },\n        contactChanged: (contacts, { payload: contact }: PayloadAction<ContactRepresentation>) => {\n            contacts.byID[contact.id] = contact;\n        },\n        contactDeleted: (contacts, { payload: contactID }: PayloadAction<string>) => {\n            delete contacts.byID[contactID];\n        },\n        strangersReceived: (contacts, { payload: strangers }: PayloadAction<HandleRepresentation[]>) => {\n            Object.assign(contacts.strangers, strangers.reduce((acc, stranger) => Object.assign(acc, {\n                [stranger.id]: stranger\n            }, {})));\n        }\n    }\n});\n\nexport const { contactsChanged, contactChanged, contactDeleted, strangersReceived } = contactsSlice.actions;\n\nexport const selectContacts = (state: RootState) => state.contacts.byID;\nexport const selectStrangers = (state: RootState) => state.contacts.strangers;\n\nexport const selectHandleIDToContact = createSelector(\n    [selectContacts],\n    (contacts) => {\n        return Object.values(contacts).reduce((acc, contact) => {\n            for (const handle of contact.handles) {\n                acc[handle.id] = contact;\n            }\n\n            return acc;\n        }, {} as Record<string, ContactRepresentation>);\n    }\n);\n\nexport default contactsSlice.reducer;","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { getPersistentValue } from \"../../util/use-persistent\";\nimport { RootState } from \"../store\";\n\ninterface DebugState {\n    showDevtools: boolean;\n    privacy: boolean;\n    invertedScrolling: boolean;\n}\n\nconst persistentConfig = {\n    showDevtools: getPersistentValue(\"showing-devtools\", false),\n    invertedScrolling: getPersistentValue(\"use-inverted-scrolling\", false)\n};\n\nconst initialState: DebugState = {\n    showDevtools: persistentConfig.showDevtools.value,\n    privacy: false,\n    invertedScrolling: persistentConfig.invertedScrolling.value\n};\n\nexport const debugSlice = createSlice({\n    name: \"debug\",\n    initialState,\n    reducers: {\n        setShowDevtools: (debug, { payload }: PayloadAction<boolean>) => {\n            debug.showDevtools = persistentConfig.showDevtools.value = payload;\n        },\n        setPrivacyMode: (debug, { payload }: PayloadAction<boolean>) => {\n            debug.privacy = payload;\n        },\n        setInvertedScrolling: (debug, { payload }: PayloadAction<boolean>) => {\n            debug.invertedScrolling = persistentConfig.invertedScrolling.value = payload;\n        }\n    }\n});\n\nexport const { setShowDevtools, setPrivacyMode, setInvertedScrolling } = debugSlice.actions;\n\nexport const selectShowingDevtools = (state: RootState) => state.debug.showDevtools;\nexport const selectIsPrivacyMode = (state: RootState) => state.debug.privacy;\nexport const selectUseInvertedScrolling = (state: RootState) => state.debug.invertedScrolling;\n\nexport default debugSlice.reducer;","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { AcknowledgmentChatItemRepresentation, AcknowledgmentType, ChatItemType, ItemStatusChangedEvent, MessageRepresentation } from \"imcore-ajax-core\";\nimport IMMakeLog from \"../../util/log\";\nimport { RootState } from \"../store\";\n\ninterface MessagesState {\n    messages: Record<string, Record<string, MessageRepresentation>>;\n    messageToChatID: Record<string, string>;\n}\n\nconst initialState: MessagesState = {\n    messages: {},\n    messageToChatID: {}\n};\n\nconst Log = IMMakeLog(\"Redux/Messages\", \"info\");\n\n\nexport const messagesSlice = createSlice({\n    name: \"messages\",\n    initialState,\n    reducers: {\n        messagesChanged: (state, { payload: messages }: PayloadAction<MessageRepresentation[]>) => {\n            const acknowledgments: AcknowledgmentChatItemRepresentation[] = [];\n\n            for (const message of messages) {\n                const messageStorage = state.messages[message.chatID] ?? (state.messages[message.chatID] = {});\n\n                messageStorage[message.id] = message;\n\n                state.messageToChatID[message.id] = message.chatID;\n\n                if (!message.associatedMessageID) continue;\n                \n                for (const item of message.items) {\n                    switch (item.type) {\n                        case ChatItemType.acknowledgment:\n                            acknowledgments.push(item.payload);\n                    }\n                }\n            }\n\n            if (!acknowledgments.length) return;\n\n            for (const acknowledgment of acknowledgments.sort((a1, a2) => a1.time - a2.time)) {\n                const messageStorage = state.messages[acknowledgment.chatID] ?? (state.messages[acknowledgment.chatID] = {});\n                const [ , messageID ] = acknowledgment.associatedID.split(acknowledgment.associatedID.includes(\"/\") ? \"/\" : \":\");\n\n                if (!messageStorage[messageID]) {\n                    Log.debug(\"Dropping dangling acknowledgment (ackID: %s, assID: %s)\", acknowledgment.id, messageID);\n                    continue;\n                }\n                \n                const associatedItem = messageStorage[messageID].items.find(messageItem => messageItem.payload.id === acknowledgment.associatedID);\n                if (!associatedItem) {\n                    Log.debug(\"Dropping phantom acknowledgment (ackID: %s, assID: %s)\", acknowledgment.id, messageID);\n                    continue;\n                }\n\n                switch (associatedItem.type) {\n                    case ChatItemType.text:\n                    case ChatItemType.attachment:\n                    case ChatItemType.plugin:\n                        if (!associatedItem.payload.acknowledgments) associatedItem.payload.acknowledgments = [];\n                        associatedItem.payload.acknowledgments = associatedItem.payload.acknowledgments.filter(ack => (acknowledgment.fromMe ? !ack.fromMe : true) && ack.id !== acknowledgment.id);\n\n                        Log.debug(\"Received acknowledgment for message %s with type %d and id %s\", messageID, acknowledgment.acknowledgmentType, acknowledgment.id);\n                        associatedItem.payload.acknowledgments.push(acknowledgment);\n                }\n            }\n        },\n        messagesDeleted: (state, { payload: messageIDs }: PayloadAction<string[]>) => {\n            for (const messageID of messageIDs) {\n                const chatID = state.messageToChatID[messageID];\n                if (!chatID || !state.messages[chatID]) return;\n                delete state.messages[chatID][messageID];\n            }\n        },\n        stopTyping: (state, { payload: messageID }: PayloadAction<string>) => {\n            const chatID = state.messageToChatID[messageID];\n            if (!chatID || !state.messages[chatID]?.[messageID]) return;\n            const message = state.messages[chatID][messageID];\n\n            if (message.items.some(item => item.type === ChatItemType.typing)) delete state.messages[chatID][messageID];\n        },\n        statusChanged(state, { payload: { chatID, id, timeDelivered, timePlayed, timeRead, time } }: PayloadAction<ItemStatusChangedEvent>) {\n            console.log({\n                chatID, id, time, timeDelivered, timeRead, timePlayed\n            });\n        },\n        stageAcknowledgmentOverride: (state, { payload: { type, messageID, chatItemID } }: PayloadAction<{\n            type: AcknowledgmentType,\n            messageID: string,\n            chatItemID: string\n        }>) => {\n            const chatID = state.messageToChatID[messageID];\n            const chat = state.messages[chatID];\n            if (!chat) return;\n\n            const item = chat[messageID]?.items.find(item => item.payload.id === chatItemID);\n            if (!item) return;\n\n            if (\"acknowledgments\" in item.payload && item.payload.acknowledgments) {\n                const oldFromMe = item.payload.acknowledgments.findIndex(ack => ack.fromMe);\n                if (oldFromMe > -1) item.payload.acknowledgments.splice(oldFromMe, 1);\n                if (type < 3000) item.payload.acknowledgments.push({\n                    id: \"...\",\n                    chatID,\n                    fromMe: true,\n                    time: Date.now(),\n                    associatedID: chatItemID,\n                    acknowledgmentType: type\n                });\n            }\n        }\n    }\n});\n\nexport const { messagesChanged, messagesDeleted, statusChanged, stageAcknowledgmentOverride } = messagesSlice.actions;\n\nexport const selectMessages = (state: RootState) => state.messages.messages;\n\nexport default messagesSlice.reducer;","import { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport IMMakeLog from \"../../util/log\";\nimport { RootState } from \"../store\";\n\ninterface PresenceState {\n    tabIsActive: boolean;\n    hoveringOverMessageID: string | null;\n    hoveringOverChatItemID: string | null;\n    hoveringOverChatID: string | null;\n}\n\nconst initialState: PresenceState = {\n    tabIsActive: true,\n    hoveringOverMessageID: null,\n    hoveringOverChatItemID: null,\n    hoveringOverChatID: null\n};\n\nconst Log = IMMakeLog(\"Redux/Presences\", \"debug\");\n\nexport const presenceSlice = createSlice({\n    name: \"presence\",\n    initialState,\n    reducers: {\n        visibilityChanged: (presence) => {\n            const isActive = document.visibilityState === \"visible\";\n\n            if (isActive !== presence.tabIsActive) Log.debug(\"Presence changed to %d\", isActive);\n\n            presence.tabIsActive = isActive;\n        },\n        messageChanged: (presence, { payload: messageID }: PayloadAction<string | null>) => {\n            presence.hoveringOverMessageID = messageID;\n        },\n        chatItemChanged: (presence, { payload: { messageID, chatItemID } }: PayloadAction<{ messageID: string | null, chatItemID: string | null }>) => {\n            presence.hoveringOverMessageID = messageID;\n            if (!messageID || (chatItemID && !chatItemID.endsWith(messageID))) chatItemID = null;\n            else if (messageID && !chatItemID) chatItemID = presence.hoveringOverChatItemID;\n            presence.hoveringOverChatItemID = chatItemID;\n        },\n        chatChanged: (presence, { payload: chatID }: PayloadAction<string | null>) => {\n            presence.hoveringOverChatID = chatID;\n        }\n    }\n});\n\nexport const { visibilityChanged, messageChanged, chatChanged, chatItemChanged } = presenceSlice.actions;\n\nexport const selectVisibilityState = (state: RootState) => state.presence.tabIsActive;\nexport const selectHoveringOverMessageID = (state: RootState) => state.presence.hoveringOverMessageID;\nexport const selectHoveringOverChatID = (state: RootState) => state.presence.hoveringOverChatID;\nexport const selectHoveringOverChatItemID = (state: RootState) => state.presence.hoveringOverChatItemID;\n\nexport default presenceSlice.reducer;","import { Action, configureStore, ThunkAction } from \"@reduxjs/toolkit\";\r\nimport chatReducer from \"./reducers/chats\";\r\nimport connectionReducer from \"./reducers/connection\";\r\nimport contactsReducer from \"./reducers/contacts\";\r\nimport debugReducer from \"./reducers/debug\";\r\nimport messagesReducer from \"./reducers/messages\";\r\nimport presenceReducer from \"./reducers/presence\";\r\n\r\nexport const store = configureStore({\r\n  reducer: {\r\n    chats: chatReducer,\r\n    messages: messagesReducer,\r\n    contacts: contactsReducer,\r\n    presence: presenceReducer,\r\n    debug: debugReducer,\r\n    connection: connectionReducer\r\n  },\r\n  middleware: (getDefaultMiddleware) =>\r\n    getDefaultMiddleware({\r\n      immutableCheck: false\r\n    })\r\n});\r\n\r\nexport type RootState = ReturnType<typeof store.getState>;\r\nexport type AppThunk<ReturnType = void> = ThunkAction<\r\n  ReturnType,\r\n  RootState,\r\n  unknown,\r\n  Action<string>\r\n>;\r\n","import { ChatItemType, MessageRepresentation } from \"imcore-ajax-core\";\nimport IMMakeLog from \"../util/log\";\nimport { setTypingStatus } from \"./reducers/chats\";\nimport { messagesDeleted } from \"./reducers/messages\";\nimport { store } from \"./store\";\n\nconst isTypingMessage = (message: MessageRepresentation) => message.isTypingMessage || message.items.some(item => item.type === ChatItemType.typing);\n\nconst Log = IMMakeLog(\"TypingAggregator\", \"debug\");\n\n/**\n * Manages the state of typing messages, expiring them and invalidating old ones as new ones arrive\n */\nexport default class TypingAggregator {\n    public static sharedInstance = new TypingAggregator();\n\n    private chats: Map<string, string | null> = new Map();\n    private timeouts: Map<string, ReturnType<typeof setTimeout> | null> = new Map();\n\n    public messageReceived(message: MessageRepresentation) {\n        if (!isTypingMessage(message)) return;\n\n        const oldMessage = this.typingMessageForChat(message.chatID);\n\n        if (oldMessage) {\n            if (oldMessage.time > message.time) return;\n            Log.info(\"Expiring dead typing message with ID %s in chta %s\", oldMessage.id, oldMessage.chatID);\n            store.dispatch(messagesDeleted([oldMessage.id]));\n        }\n\n        this.chats.set(message.chatID, message.id);\n\n        if (this.timeouts.has(message.chatID)) clearTimeout(this.timeouts.get(message.chatID)!);\n        \n        this.timeouts.set(message.chatID, setTimeout(() => {\n            if (this.typingMessageForChat(message.chatID)?.id === message.id) {\n                store.dispatch(messagesDeleted([message.id]));\n                store.dispatch(setTypingStatus({ chatID: message.chatID, typing: false }));\n                this.chats.delete(message.chatID);\n            }\n\n            this.timeouts.delete(message.chatID);\n        }, 30000));\n    }\n\n    public messagesReceived(messages: MessageRepresentation[]) {\n        for (const message of messages) {\n            this.messageReceived(message);\n        }\n    }\n\n    private typingMessageForChat(chatID: string): MessageRepresentation | null {\n        if (!this.chats.get(chatID)) return null;\n        const typingMessageID = this.chats.get(chatID)!;\n\n        const message = store.getState().messages.messages[chatID]?.[typingMessageID];\n\n        if (!message) return null;\n\n        if (!isTypingMessage(message)) {\n            this.chats.set(chatID, null);\n            return null;\n        }\n\n        return message;\n    }\n}\n","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport React, { useContext, useMemo } from \"react\";\nimport AutoSizer from \"react-virtualized-auto-sizer\";\nimport { areEqual, FixedSizeList as List } from \"react-window\";\nimport { chatChanged } from \"../app/reducers/presence\";\nimport { store } from \"../app/store\";\nimport { ChatSearchContext } from \"../contexts/ChatSearchContext\";\nimport \"../styles/ChatSidebar.scss\";\nimport { findAncestor } from \"../util/dom\";\nimport ChatSidebarItem from \"./ChatSidebarItem\";\nimport { TypedListChildComponentProps } from \"./react-window-dynamic/DynamicSizeList\";\n\nfunction findChatID(element: HTMLElement): string | null {\n    return findAncestor(element, ancestor => {\n        return ancestor.hasAttribute(\"attr-chat-id\");\n    })?.getAttribute(\"attr-chat-id\") || null;\n}\n\nconst RowRenderer = React.memo(function RowRenderer({\n    index,\n    data,\n    style\n}: TypedListChildComponentProps<ChatRepresentation[]>) {\n    if (!data[index]) return null;\n\n    return (\n        <ChatSidebarItem style={style} chat={data[index]} />\n    );\n}, (prevProps, nextProps) => {\n    if (!areEqual(prevProps, nextProps)) return false;\n\n    const prevChat = prevProps.data[prevProps.index];\n    const nextChat = nextProps.data[nextProps.index];\n\n    if (prevChat.id !== nextChat.id) return false;\n    if (prevChat.lastMessage !== nextChat.lastMessage) return false;\n    if (prevChat.lastMessageTime !== nextChat.lastMessageTime) return false;\n    if (prevChat.unreadMessageCount !== nextChat.unreadMessageCount) return false;\n    if (prevChat.displayName !== nextChat.displayName) return false;\n    if (prevChat.ignoreAlerts !== nextChat.ignoreAlerts) return false;\n    if (prevChat.groupPhotoID !== nextChat.groupPhotoID) return false;\n    if (JSON.stringify(prevChat.participants) !== JSON.stringify(nextChat.participants)) return false;\n\n    return true;\n});\n\nfunction ChatSidebar() {\n    const { chatResults } = useContext(ChatSearchContext);\n\n    const chats = useMemo(() => chatResults.slice().sort((c1, c2) => c2.lastMessageTime - c1.lastMessageTime), [chatResults]);\n\n    return (\n        <div onMouseOver={event => {\n            if (!(event.target instanceof HTMLElement)) return;\n            const currentChatID = findChatID(event.target);\n            if (!currentChatID) return;\n            if (currentChatID === store.getState().presence.hoveringOverChatID) return;\n            store.dispatch(chatChanged(currentChatID));\n        }}>\n            <AutoSizer>\n                {({height}) => (\n                    <List\n                        height={height}\n                        className=\"chat-sidebar\"\n                        itemCount={chats.length}\n                        itemData={chats}\n                        itemSize={60}\n                        itemKey={(index: number, data: ChatRepresentation[]) => data[index]?.id || Math.random()}\n                        overscanCount={35}\n                        width={285}\n                    >\n                        {RowRenderer}\n                    </List>\n                )}\n            </AutoSizer>\n        </div>\n    );\n}\n\nexport default ChatSidebar;","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithChildren } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Link } from \"react-router-dom\";\nimport { selectTypingStatus } from \"../app/reducers/chats\";\nimport { RootState } from \"../app/store\";\nimport useChatName from \"../hooks/useChatName\";\nimport \"../styles/ChatSidebarItem.scss\";\nimport { useFormattedReceipt } from \"../util/receipt-formatting\";\nimport ChatBubble from \"./chat/ChatBubble\";\nimport { useCurrentChat } from \"./transcript/ChatTranscriptFoundation\";\nimport IMTypingChatItem from \"./transcript/items/chat/IMTypingChatItem\";\n\nfunction useLastMessageTime(chat: ChatRepresentation) {\n    return useFormattedReceipt(chat.lastMessageTime);\n}\n\nfunction ChatSidebarItem({ chat, style }: PropsWithChildren<{ chat: ChatRepresentation, style?: object }>) {\n    const chatName = useChatName(chat);\n    const currentChat = useCurrentChat();\n    const lastMessageTime = useLastMessageTime(chat);\n    const isTyping = useSelector(state => selectTypingStatus(state as RootState, chat.id));\n\n    const isActive = currentChat?.id === chat.id;\n\n    return (\n        <Link to={`/chats/${chat.id}`} attr-chat-id={chat.id} className=\"chat-sidebar-item\" attr-chat-active={isActive.toString()} attr-unread-count={chat.unreadMessageCount} style={style}>\n            <div className=\"chat-sidebar-item--image\">\n                <ChatBubble chat={chat} />\n            </div>\n            <div className=\"chat-sidebar-item--details\">\n                <span className=\"chat-sidebar-item--title\">\n                    <span className=\"chat-sidebar-item--title-label\">\n                        {chatName}\n                    </span>\n                    <span className=\"chat-sidebar-item--title-timestamp\">\n                        {lastMessageTime}\n                    </span>\n                </span>\n                <span className=\"chat-sidebar-item--summary\">\n                    {\n                        isTyping ? (\n                            <div data-item-type=\"typing\">\n                                <div className=\"item-inner\">\n                                    <IMTypingChatItem />\n                                </div>\n                            </div>\n                        ) : chat.lastMessage || \"\"\n                    }\n                </span>\n            </div>\n        </Link>\n    );\n}\n\nexport default ChatSidebarItem;","import React, { useContext } from \"react\";\nimport { ReactComponent as MagnifyingGlass } from \"../../assets/magnifying-glass.svg\";\nimport { ReactComponent as PenAndPencil } from \"../../assets/pen.pencil.svg\";\nimport { ChatSearchContext } from \"../../contexts/ChatSearchContext\";\n\nexport default function ChatBar() {\n    const { searchCriteria, setSearchCriteria } = useContext(ChatSearchContext);\n\n    return (\n        <div className=\"chat-toolbar\">\n            <label className=\"search-field\">\n                <MagnifyingGlass />\n                <input type=\"search\" placeholder=\"Search\" value={searchCriteria || \"\"} onChange={event => {\n                    setSearchCriteria((event.target as HTMLInputElement).value);\n                }} />\n            </label>\n            <button className=\"new-chat\">\n                <PenAndPencil />\n            </button>\n        </div>\n    );\n}","import React from \"react\";\nimport useChatName from \"../../hooks/useChatName\";\nimport { useCurrentChat } from \"../transcript/ChatTranscriptFoundation\";\n\nexport default function TranscriptBar() {\n    const chat = useCurrentChat();\n    const chatName = useChatName(chat);\n\n    return (\n        <div className=\"transcript-toolbar\">\n            <div className=\"chat-name\">\n                {chatName}\n            </div>\n        </div>\n    );\n}","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithChildren, useEffect, useState } from \"react\";\nimport { apiClient } from \"../../app/connection\";\nimport { useContactResolver } from \"../../hooks/useContactResolver\";\nimport CNContactBubble from \"../contacts/CNContactBubble\";\n\nexport enum ChatStyle {\n    group = 43,\n    solo = 45\n}\n\nfunction DMBubble(props: PropsWithChildren<{ chat: ChatRepresentation }>) {\n    const chat = props.chat;\n    const [recipientID, setRecipientID] = useState([] as string[]);\n\n    useEffect(() => {\n        setRecipientID(chat.participants);\n    }, [chat]);\n\n    const contacts = useContactResolver(recipientID);\n\n    return (\n        <CNContactBubble className=\"chat-bubble--image\" contact={contacts[0]} />\n    );\n}\n\nfunction GroupChatBubble(props: PropsWithChildren<{ chat: ChatRepresentation }>) {\n    const chat = props.chat;\n    const [lastTwoHandleIDs, setLastTwoHandleIDs] = useState([] as string[]);\n\n    useEffect(() => {\n        setLastTwoHandleIDs(chat.participants.slice(0, 2));\n    }, [chat]);\n\n    const contacts = useContactResolver(lastTwoHandleIDs);\n\n    return (\n        <div className=\"chat-bubble--multi-container\">\n            <CNContactBubble className=\"chat-bubble--image\" contact={contacts[0]} />\n            <CNContactBubble className=\"chat-bubble--image\" contact={contacts[1]} />\n        </div>\n    );\n}\n\nfunction ChatBubble(props: PropsWithChildren<{ chat: ChatRepresentation }>) {\n    const chat = props.chat;\n\n    if (chat.style === ChatStyle.group) {\n        if (chat.groupPhotoID) {\n            return (\n                <div className=\"cn-bubble chat-bubble--image\" style={{\n                    backgroundImage: `url(${apiClient.attachmentURL(chat.groupPhotoID)})`\n                }} />\n            );\n        } else {\n            return (\n                <GroupChatBubble chat={chat} />\n            );\n        }\n    } else {\n        return (\n            <DMBubble chat={chat} />\n        );\n    }\n}\n\nexport default ChatBubble;","import { ContactRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithChildren, useLayoutEffect, useState } from \"react\";\nimport { apiClient } from \"../../app/connection\";\nimport \"../../styles/contacts/CNContactBubble.scss\";\n\nexport default function CNContactBubble(props: PropsWithChildren<{ contact: ContactRepresentation | null; className?: string; }>) {\n    const contact = props.contact;\n    const [backgroundPhotoURL, setBackgroundPhotoURL] = useState(null as string | null);\n    const [contactInitials, setContactInitials] = useState(null as string | null);\n\n    useLayoutEffect(() => {\n        setBackgroundPhotoURL(contact?.hasPicture ? apiClient.contactPhotoURL(contact.id) : null);\n\n        if (contact) {\n            const { firstName, lastName } = contact;\n            if (!firstName && !lastName) setContactInitials(null);\n            else {\n                let initials = \"\";\n                if (firstName) initials += firstName[0].toUpperCase();\n                if (lastName) initials += lastName[0].toUpperCase();\n                setContactInitials(initials);\n            }\n        } else {\n            setContactInitials(null);\n        }\n    }, [contact]);\n\n    return (\n        <div className={`${backgroundPhotoURL ? \"cn-bubble\" : contactInitials ? \"cn-bubble cn-bubble-initials\" : \"cn-bubble cn-bubble-empty\"}${props.className ? ` ${props.className}` : \"\"}`} style={backgroundPhotoURL ? {\n            backgroundImage: `url(${backgroundPhotoURL})`\n        }: {}}>\n            {contactInitials}\n        </div>\n    );\n}","import React from \"react\";\nimport DebugSettings from \"./sections/DebugSettings\";\nimport GroupSettings from \"./sections/GroupSettings\";\nimport Settings from \"./sections/Settings\";\nimport Statistics from \"./sections/Statistics\";\n\nexport default function DevtoolsRoot() {\n    return (\n        <div className=\"devtools-root\">\n            <Statistics />\n            <DebugSettings />\n            <GroupSettings />\n            <Settings />\n        </div>\n    );\n}","import React from \"react\";\n\nexport interface DebugBooleanContext {\n    name: string;\n    value: boolean;\n    onInput: (value: boolean) => any;\n}\n\nexport default function DebugBoolean({ name, value, onInput }: DebugBooleanContext) {\n    return (\n        <label className=\"detail-row detail-checkbox\">\n            <span className=\"detail-label\">{name}</span>\n            <input type=\"checkbox\" className=\"detail-info\" checked={value} onChange={() => onInput(!value)} />\n        </label>\n    );\n}","import React from \"react\";\n\nexport type Stringable = string | number | boolean | null | undefined;\n\nexport default function DebugDetails({ details }: { details: [Stringable, Stringable][] }) {\n    return (\n        <div className=\"debug-details\">\n            {details.map(([ name, value ], index) => (\n                <div className=\"detail-row\" key={index}>\n                    <span className=\"detail-label\">{name?.toString()}</span>\n                    <span className=\"detail-info\">{value?.toString()}</span>\n                </div>\n            ))}\n        </div>\n    );\n}","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectIsPrivacyMode, setPrivacyMode } from \"../../../app/reducers/debug\";\nimport { store } from \"../../../app/store\";\nimport DebugBoolean from \"../presentation/DebugBoolean\";\n\nexport default function DebugSettings() {\n    const isPrivacy = useSelector(selectIsPrivacyMode);\n\n    return (\n        <React.Fragment>\n            <details>\n                <summary>Debug Settings</summary>\n\n                <DebugBoolean name=\"Privacy Mode\" value={isPrivacy} onInput={newIsPrivacy => store.dispatch(setPrivacyMode(newIsPrivacy))} />\n            </details>\n        </React.Fragment>\n    );\n}","import React, { ReactNode, useEffect, useState } from \"react\";\nimport { apiClient } from \"../../../app/connection\";\nimport { EventBus } from \"../../../hooks/useEvent\";\nimport { DSLDebugTools } from \"../../react-window-dynamic/DynamicSizeList\";\nimport { useCurrentChat } from \"../../transcript/ChatTranscriptFoundation\";\n\nfunction DraftInput({ label, placeholder, value, commit }: { label: ReactNode, placeholder: string | undefined, value: string | undefined, commit: (savedValue: string | undefined | null) => any }) {\n    const [ draft, setDraft ] = useState<string | undefined | null>(null!);\n    const [ busy, setBusy ] = useState(false);\n\n    if (draft === null) setDraft(value);\n\n    useEffect(() => {\n        setDraft(value);\n    }, [value]);\n\n    return (\n        <label className=\"detail-row detail-input\">\n            <span className=\"detail-label\">{label}</span>\n            <input type=\"text\" placeholder={placeholder} value={draft!} onChange={e => {\n                setDraft(e.target.value);\n            }} onKeyDown={async e => {\n                if (busy) return;\n                \n                if (e.key !== \"Enter\") return;\n                e.preventDefault();\n                setBusy(true);\n                \n                try {\n                    await commit(draft);\n                } finally {\n                    setBusy(false);\n                }\n            }} />\n        </label>\n    );\n}\n\ninterface InputProps {\n    disabled?: boolean;\n    className?: string;\n    children?: ReactNode;\n}\n\ninterface CheckboxProps extends InputProps {\n    value: boolean;\n    changed: (value: boolean) => any;\n}\n\nconst mergeClassName = (className: string, className1?: string | undefined) => `${className}${className1 ? ` ${className1}` : \"\"}`;\n\ntype AnonymizedFunction<T> = T extends (...args: infer U) => any ? (...args: U) => Promise<void> : never;\n\nfunction useBusyController<T extends (...args: any) => any>({ disabled, fn }: { disabled?: boolean, fn: T }): [ boolean, AnonymizedFunction<T> ] {\n    const [ busy, setBusy ] = useState(false);\n    const canProceed = !(busy || disabled);\n\n    return [\n        !canProceed,\n        (async (...args: Parameters<T>[]) => {\n            if (!canProceed) return;\n\n            setBusy(true);\n            await fn(...args);\n            setBusy(false);\n        }) as unknown as AnonymizedFunction<T>\n    ];\n}\n\nfunction DebugCheckbox({ disabled, changed, className, children, value }: CheckboxProps) {\n    const [ isDisabled, fire ] = useBusyController({ disabled, fn: changed });\n\n    return (\n        <label className={mergeClassName(\"detail-row detail-checkbox\", className)}>\n            <span className=\"detail-label\">{children}</span>\n            <input disabled={isDisabled} type=\"checkbox\" className=\"detail-info\" checked={value} onChange={async ev => {\n                fire(ev.target.checked);\n            }} />\n        </label>\n    );\n}\n\ninterface ButtonProps extends InputProps {\n    click: () => any;\n}\n\nfunction DebugButton({ disabled, click, className, children }: ButtonProps) {\n    const [ isDisabled, fire ] = useBusyController({ disabled, fn: click });\n\n    return (\n        <button className={mergeClassName(\"detail-row detail-btn\", className)} disabled={isDisabled} onClick={e => {\n            e.preventDefault();\n            fire();\n        }}>\n            {children}\n        </button>\n    );\n}\n\nexport default function GroupSettings() {\n    const currentChat = useCurrentChat();\n\n    if (!currentChat) return null;\n\n    return (\n        <>\n            <details>\n                <summary>Chat Settings</summary>\n                \n                <div className=\"debug-details\">\n                    <DebugCheckbox value={currentChat.readReceipts} changed={readReceipts => apiClient.chats.patchProperties(currentChat.id, { readReceipts })}>\n                        Send Read Receipts\n                    </DebugCheckbox>\n\n                    <DebugCheckbox value={currentChat.ignoreAlerts} changed={ignoreAlerts => apiClient.chats.patchProperties(currentChat.id, { ignoreAlerts })}>\n                        Ignore Alerts\n                    </DebugCheckbox>\n\n                    <DebugButton click={() => apiClient.chats.readAllMessages(currentChat.id)}>\n                        Mark All As Read\n                    </DebugButton>\n\n                    <DebugButton click={() => apiClient.chats.setTyping(currentChat.id, true)}>\n                        Start Typing\n                    </DebugButton>\n\n                    <DebugButton click={() => apiClient.chats.setTyping(currentChat.id, false)}>\n                        Stop Typing\n                    </DebugButton>\n\n                    <DebugButton click={() => apiClient.chats.deleteChat(currentChat.id)}>\n                        Delete Chat\n                    </DebugButton>\n                </div>\n            </details>\n            <details>\n                <summary>DSL</summary>\n\n                <div className=\"debug-details\">\n                    {DSLDebugTools.map(({ name, event }) => (\n                        <DebugButton key={name} click={() => EventBus.emit(event)}>\n                            {name}\n                        </DebugButton>\n                    ))}\n                </div>\n            </details>\n            {currentChat.style === 43 ? (\n                <details>\n                    <summary>Group Settings</summary>\n                    <DraftInput label={<>Group Name</>} placeholder=\"Group Name\" value={currentChat.displayName} commit={newGroupName => {\n                        apiClient.chats.rename(currentChat.id, newGroupName || null);\n                    }} />\n\n                    <div className=\"detail-row\">\n                        <span className=\"detail-label\">Participants</span>\n                        {\n                            currentChat.participants.map(participant => (\n                                <div className=\"detail-info\" key={participant}>\n                                    {participant}\n                                    <DebugButton click={async () => {\n                                        await apiClient.chats.removeParticipants(currentChat.id, [participant]);\n                                    }}>\n                                        Remove\n                                    </DebugButton>\n                                </div>\n                            ))\n                        }\n                    </div>\n                </details>\n            ) : null}\n        </>\n    );\n}","import React, { useState } from \"react\";\nimport GitInfo from \"react-git-info/macro\";\nimport { useSelector } from \"react-redux\";\nimport { reconnect } from \"../../../app/connection\";\nimport { selectUseInvertedScrolling, setInvertedScrolling } from \"../../../app/reducers/debug\";\nimport { store } from \"../../../app/store\";\nimport { usePersistent } from \"../../../util/use-persistent\";\nimport DebugBoolean from \"../presentation/DebugBoolean\";\n\nconst shortHash = GitInfo().commit.shortHash;\n\nexport default function DebugSettings() {\n    const isScrollingInverted = useSelector(selectUseInvertedScrolling);\n    const [imCoreHost, setIMCoreHost] = usePersistent(\"imcore-host\", \"localhost\");\n    const [isReconnecting, setIsReconnecting] = useState(false);\n\n    return (\n        <React.Fragment>\n            <details>\n                <summary>Settings</summary>\n\n                <DebugBoolean name=\"Scrolling Fix\" value={isScrollingInverted} onInput={e => store.dispatch(setInvertedScrolling(e))} />\n\n                <button className=\"detail-row detail-btn\" onClick={() => {\n                    const initial = isScrollingInverted;\n                    store.dispatch(setInvertedScrolling(!initial));\n                    setTimeout(() => store.dispatch(setInvertedScrolling(initial)), 25);\n                }}>Reset Scrolling</button>\n\n                <label className=\"detail-row detail-input\">\n                    <span className=\"detail-label\">IMCore Host</span>\n                    <input type=\"text\" placeholder=\"localhost:8090\" value={imCoreHost} onChange={event => setIMCoreHost(event.target.value)} />\n                </label>\n\n                <button className=\"detail-row detail-btn\" disabled={isReconnecting} onClick={() => {\n                    setIsReconnecting(true);\n                    reconnect().then(() => {\n                        setIsReconnecting(false);\n                    });\n                }}>Reconnect</button>\n\n                <label className=\"detail-row\">\n                    <span className=\"detail-label\">IMCore.React {shortHash}</span>\n                </label>\n            </details>\n        </React.Fragment>\n    );\n}","import React from \"react\";\nimport ReactJson from \"react-json-view\";\nimport { useSelector } from \"react-redux\";\nimport { selectChats } from \"../../../app/reducers/chats\";\nimport { selectMessages } from \"../../../app/reducers/messages\";\nimport { ChatStyle } from \"../../chat/ChatBubble\";\nimport AcknowledgmentPicker from \"../../transcript/acknowledgments/AcknowledgmentPicker\";\nimport { useCurrentChat, useHoveredChat, useHoveredChatItem } from \"../../transcript/ChatTranscriptFoundation\";\nimport DebugDetails from \"../presentation/DebugDetails\";\n\nexport default function Statistics() {\n    const loadedChats = Object.values(useSelector(selectChats)).length;\n    const loadedMessages = Object.values(useSelector(selectMessages)).flatMap(record => Object.values(record)).length;\n\n    const currentChat = useCurrentChat();\n\n    const [ hoveredChatItem, hoveredMessage ] = useHoveredChatItem();\n    const hoveredChat = useHoveredChat();\n\n    return (\n        <>\n            <details>\n                <summary>Statistics</summary>\n                <DebugDetails details={[\n                    [\"Loaded Chats\", loadedChats],\n                    [\"Loaded Messages\", loadedMessages]\n                ]} />\n            </details>\n            <details>\n                <summary>Chat Statistics</summary>\n                <DebugDetails details={[\n                    [\"Current Chat\", currentChat?.id],\n                    [\"Muted?\", currentChat?.ignoreAlerts ? \"Yes\" : \"No\"],\n                    [\"Send Read Receipts?\", currentChat?.readReceipts ? \"Yes\" : \"No\"],\n                    [\"Service\", currentChat?.service],\n                    [\"Group?\", currentChat?.style === ChatStyle.group ? \"Yes\" : \"No\"]\n                ]} />\n            </details>\n            <details>\n                <summary>Message Information</summary>\n                <ReactJson src={hoveredMessage || {}} />\n            </details>\n            <details>\n                <summary>Acknowledgments</summary>\n                <DebugDetails details={[\n                    [\"Hovered Message ID\", hoveredMessage?.id],\n                    [\"Hovered Message Sender\", hoveredMessage?.sender],\n                    [\"Hovered Message Time\", hoveredMessage?.time || NaN],\n                    [\"Hovered ChatItem ID\", hoveredChatItem?.payload.id]\n                ]} />\n                {\n                    (hoveredMessage && hoveredChatItem) ? (\n                        <AcknowledgmentPicker message={hoveredMessage} chatItem={hoveredChatItem} />\n                    ) : null\n                }\n            </details>\n            <details>\n                <summary>Chat Information</summary>\n                <ReactJson src={hoveredChat || {}} />\n            </details>\n        </>\n    );\n}","import { createContext, useCallback, useEffect, useRef } from \"react\";\n\nexport const DynamicListContext = createContext<\n    Partial<{ setSize: (id: string, size: number) => void }>\n>({});\n\nexport const useInvertScrollDirection = (enabled: boolean) => {\n    const ref = useRef<HTMLDivElement>();\n\n    const invertedWheelEvent = useCallback((e: WheelEvent) => {\n        if (ref.current) {\n            ref.current.scrollTop += -e.deltaY;\n            e.preventDefault();\n        }\n    }, []);\n\n    useEffect(\n        () => () => {\n            if (ref.current) {\n                ref.current.removeEventListener(\"wheel\", invertedWheelEvent);\n            }\n        },\n        []\n    );\n\n    const repair = useCallback(() => {\n        if (!ref.current) return;\n\n        ref.current.removeEventListener(\"wheel\", invertedWheelEvent);\n        if (enabled) ref.current.addEventListener(\"wheel\", invertedWheelEvent);\n    }, [ref, enabled, invertedWheelEvent]);\n\n    useEffect(() => repair(), [enabled, repair, ref]);\n\n    return (incomingRef: HTMLDivElement | null) => {\n        if (!incomingRef) {\n            return;\n        }\n\n        ref.current = incomingRef;\n    };\n};\n\nexport function isMacOS() {\n    return navigator.userAgent.toLowerCase().includes(\"mac os x\");\n};\n\nexport const hostIsMacOS = isMacOS();","import React, { CSSProperties, MutableRefObject, ReactNode, useCallback, useContext, useEffect, useMemo, useRef } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { areEqual, ListChildComponentProps, VariableSizeList } from \"react-window\";\nimport { selectUseInvertedScrolling } from \"../../app/reducers/debug\";\nimport { EventTypes, useEvent } from \"../../hooks/useEvent\";\nimport IMMakeLog from \"../../util/log\";\nimport { DynamicListContext, hostIsMacOS, useInvertScrollDirection } from \"./DynamicSizeList.Foundation\";\n\nexport type RowRenderingContext<T extends { id: string },\n MemoState> = RowMeasurerPropsWithoutChildren<T, MemoState> & {\n    ref: MutableRefObject<Element | null>;\n};\n\nexport interface RowRenderer<T extends { id: string }, MemoState> {\n    (ctx: RowRenderingContext<T, MemoState>): ReactNode\n}\n\nexport interface RowMeasurerProps<T extends { id: string }, MemoState> {\n    index: number;\n    id: string;\n    width: number;\n    data: T[];\n    style: CSSProperties;\n    children: RowRenderer<T, MemoState>;\n    memoState: MemoState;\n}\n\nexport type RowMeasurerPropsWithoutChildren<T extends { id: string }, MemoState> = Omit<RowMeasurerProps<T, MemoState>, \"children\">;\n\nexport function RowMeasurer<T extends { id: string }, MemoState>({ index, id, width, data, style, children, memoState }: RowMeasurerProps<T, MemoState>) {\n    const { setSize } = useContext(DynamicListContext);\n    const rowRoot = useRef<null | HTMLDivElement>(null);\n\n    const observer = useRef(new ResizeObserver((([ entry ]: ResizeObserverEntry[]) => {\n        if (setSize && entry.contentRect.height) {\n            setSize(id, entry.contentRect.height);\n        }\n    })));\n    \n    useEffect(() => {\n        if (rowRoot.current) {\n            observer.current.disconnect();\n            observer.current.observe(rowRoot.current);\n        }\n    }, [id, setSize, width]);\n\n    return (\n        <div style={style}>\n            {children({\n                ref: rowRoot,\n                index,\n                data,\n                id,\n                width,\n                style,\n                memoState\n            })}\n        </div>\n    );\n}\n\nexport type TypedListChildComponentProps<T = any> = Omit<ListChildComponentProps, \"data\"> & {\n    data: T;\n}\n\nconst Log = IMMakeLog(\"ReactWindow.DynamicSizeList\", \"info\");\n\nexport interface DynamicSizeListProps<T extends { id: string }, MemoState> {\n    height: number;\n    width: number;\n    nonce?: string;\n    itemData: T[];\n    getID: (index: number) => string;\n    itemCount: number;\n    children: RowRenderer<T, MemoState>;\n    overscanCount?: number;\n    outerRef?: any;\n    innerRef?: any;\n    nearEnd?: () => void;\n    isSame?: (oldProps: RowMeasurerPropsWithoutChildren<T, MemoState>, newProps: RowMeasurerPropsWithoutChildren<T, MemoState>) => boolean;\n    memoState: MemoState;\n    itemKey?: (index: number, data: T[]) => string;\n}\n\nconst sizeStorage: Map<string, Record<string, number>> = new Map();\n\nexport const DSLDebugTools: Array<{\n    name: string;\n    event: keyof EventTypes\n}> = [\n    { name: \"Reset DSL\", event: \"resetDynamicSizeList\" },\n    { name: \"Dump DSL ListRef\", event: \"dumpDSLListRef\" },\n    { name: \"Dump DSL SizeMap\", event: \"dumpDSLMeasurements\" },\n    { name: \"Rescroll DSL\", event: \"dslRescroll\" }\n];\n\nexport default function DynamicSizeList<T extends { id: string }, MemoState>(props: DynamicSizeListProps<T, MemoState>) {\n    const listRef = useRef<VariableSizeList | null>(null);\n    const scrollWatcher = useInvertScrollDirection(useSelector(selectUseInvertedScrolling) || hostIsMacOS);\n\n    const sizeMap = React.useRef<{ [key: string]: number }>({});\n\n    const resetList = useCallback(async () => {\n        Log.debug(\"Resetting DynamicSizeList\");\n\n        listRef.current?.resetAfterIndex(0);\n    }, [listRef]);\n\n    const setSize = React.useCallback((id: string, size: number) => {\n        // Performance: Only update the sizeMap and reset cache if an actual value changed\n        if (sizeMap.current[id] !== size) {\n            Log.debug(\"DynamicSizeList caught resize\", { id, from: sizeMap.current[id], to: size });\n            sizeMap.current = { ...sizeMap.current, [id]: size };\n            sizeStorage.set(props.nonce!, sizeMap.current);\n            \n            if (listRef.current) {\n                // Clear cached data and rerender\n                Log.debug(\"DynamicSizeList rerendering VariableSizeList\");\n                resetList();\n            }\n        }\n    }, [props.nonce, listRef, resetList, sizeMap]);\n\n    useEvent(\"resetDynamicSizeList\", resetList);\n\n    useEvent(\"dumpDSLListRef\", () => console.log(listRef.current));\n    useEvent(\"dumpDSLMeasurements\", () => console.log(sizeMap.current));\n\n    useEvent(\"dslRescroll\", () => {\n        listRef.current?.scrollTo((listRef.current.state as { scrollOffset: number }).scrollOffset);\n    });\n\n    useEffect(() => {\n        resetList();\n    }, [props.itemData.length]);\n\n    useEffect(() => {\n        sizeMap.current = sizeStorage.get(props.nonce!) || {};\n        listRef.current?.resetAfterIndex(0);\n        listRef.current?.scrollToItem(0);\n        Log.debug(\"Cleared caches\");\n    }, [props.nonce]);\n\n    const getSize = React.useCallback((index: number) => (\n        sizeMap.current[props.getID(index)] || 25\n    ), [props.itemData, sizeMap]);\n\n    // Increases accuracy by calculating an average row height\n    // Fixes the scrollbar behaviour described here: https://github.com/bvaughn/react-window/issues/408\n    const calcEstimatedSize = React.useCallback(() => {\n        const keys = Object.keys(sizeMap.current);\n        const estimatedHeight = keys.reduce((p, i) => p + sizeMap.current[i], 0);\n        return estimatedHeight / keys.length;\n    }, [sizeMap]);\n\n    const MemoizedRowMeasurer = useMemo(() => {\n        Log.debug(\"Regenerating memo component\");\n\n        const createRendererProps = (rowProps: TypedListChildComponentProps<T[]>, listProps: DynamicSizeListProps<T, MemoState> = props, memoState: MemoState = props.memoState): Omit<RowMeasurerProps<T, MemoState>, \"children\"> => ({\n            ...rowProps,\n            id: rowProps.data[rowProps.index].id,\n            width: listProps.width,\n            memoState\n        });\n\n        function Renderer(rowProps: ListChildComponentProps) {\n            return (\n                <RowMeasurer {...createRendererProps(rowProps)} key={rowProps.data[rowProps.index].id}>\n                    {props.children as any}\n                </RowMeasurer>\n            );\n        }\n\n        return props.isSame ? React.memo<ListChildComponentProps>(Renderer, (prevProps, nextProps) => {\n            return areEqual(prevProps, nextProps) && props.isSame!(createRendererProps(prevProps), createRendererProps(nextProps));\n        }) : Renderer;\n    }, [props.isSame, props.memoState]);\n\n    return (\n        <DynamicListContext.Provider value={{ setSize }}>\n            <VariableSizeList\n                ref={listRef}\n                width={props.width}\n                height={props.height}\n                itemCount={props.itemCount}\n                itemData={props.itemData}\n                itemSize={getSize}\n                estimatedItemSize={calcEstimatedSize()}\n                outerRef={scrollWatcher}\n                overscanCount={props.overscanCount}\n                onItemsRendered={props.nearEnd ? ({ overscanStartIndex, overscanStopIndex }) => overscanStopIndex >= (props.itemData.length - 10) ? props.nearEnd!() : undefined : undefined}\n                itemKey={props.itemKey}\n                >\n                {MemoizedRowMeasurer}\n            </VariableSizeList>\n        </DynamicListContext.Provider>\n    );\n}","import { MessageRepresentation } from \"imcore-ajax-core\";\nimport React, { useCallback, useEffect, useMemo, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport AutoSizer from \"react-virtualized-auto-sizer\";\nimport { apiClient } from \"../../app/connection\";\nimport { chatItemChanged, selectVisibilityState } from \"../../app/reducers/presence\";\nimport { store } from \"../../app/store\";\nimport IMMakeLog from \"../../util/log\";\nimport DynamicSizeList, { RowMeasurerPropsWithoutChildren } from \"../react-window-dynamic/DynamicSizeList\";\nimport { useCurrentChat, useCurrentMessages } from \"./ChatTranscriptFoundation\";\nimport Composition from \"./composition/Composition\";\nimport Message from \"./items/Message\";\nimport { itemsAreShallowEqual } from \"./items/Message.foundation\";\n\nconst MemoLog = IMMakeLog(\"MessageMemo\", \"error\");\n\nfunction messagesAreRenderSame(prevMessage: MessageRepresentation | undefined, nextMessage: MessageRepresentation | undefined) {\n    if ((!prevMessage && !nextMessage) || !(prevMessage && nextMessage)) return false;\n\n    if (prevMessage.id !== nextMessage.id) {\n        MemoLog.info(\"MessageID not equal (%s !== %s)\", prevMessage.id, nextMessage.id);\n        return false;\n    }\n    else if (!itemsAreShallowEqual(prevMessage, nextMessage)) {\n        MemoLog.info(\"Items are not shallow equal (%o !== %o)\", prevMessage, nextMessage);\n        return false;\n    }\n    else {\n        MemoLog.debug(\"Items are same\");\n        return true;\n    }\n}\n\ninterface MessagesMemoState {\n    lastDeliveredFromMe?: string;\n    lastReadFromMe?: string;\n}\n\nfunction compareMessageRenderProps(prevProps: RowMeasurerPropsWithoutChildren<MessageRepresentation, MessagesMemoState>, nextProps: RowMeasurerPropsWithoutChildren<MessageRepresentation, MessagesMemoState>): boolean {\n    const prevBeforeMessage = prevProps.data[prevProps.index - 1];\n    const nextBeforeMessage = nextProps.data[nextProps.index - 1];\n\n    const prevMessage = prevProps.data[prevProps.index];\n    const nextMessage = nextProps.data[nextProps.index];\n\n    const prevAfterMessage = prevProps.data[prevProps.index + 1];\n    const nextAfterMessage = nextProps.data[nextProps.index + 1];\n\n    return (\n        messagesAreRenderSame(prevBeforeMessage, nextBeforeMessage)\n     && messagesAreRenderSame(prevMessage, nextMessage)\n     && messagesAreRenderSame(prevAfterMessage, nextAfterMessage)\n    );\n}\n\nfunction getLastReadAndDeliveredFromMe(messages: MessageRepresentation[]): [string | undefined, string | undefined] {\n    let lastDeliveredFromMe: string | undefined = undefined, lastReadFromMe: string | undefined = undefined;\n\n    for (const { id, fromMe, isDelivered, timeRead } of messages) {\n        if (!lastDeliveredFromMe && fromMe && isDelivered) lastDeliveredFromMe = id;\n        if (!lastReadFromMe && fromMe && timeRead) lastReadFromMe = id;\n        if (lastDeliveredFromMe && lastReadFromMe) break;\n    }\n\n    return [lastDeliveredFromMe, lastReadFromMe];\n}\n\nfunction searchNodeForMessageRelations(node: Node): {\n    chatItemID: string | null;\n    messageID: string | null;\n} {\n    let chatItemID: string | null = null, messageID: string | null = null;\n\n    let next: Node | null = node;\n    while (next !== null) {\n        if (next instanceof HTMLElement) {\n            if (!chatItemID) chatItemID = next.getAttribute(\"attr-chat-item-id\");\n            if (!messageID) messageID = next.getAttribute(\"attr-message-id\");\n        }\n\n        if ((chatItemID && messageID) || (messageID && !chatItemID)) break;\n\n        next = next.parentNode;\n    }\n\n    return {\n        chatItemID,\n        messageID\n    };\n}\n\nexport default function ChatTranscript() {\n    const chat = useCurrentChat();\n    const [ messages, loadMore ] = useCurrentMessages();\n\n    const [lastDeliveredFromMe, lastReadFromMe] = useMemo(() => getLastReadAndDeliveredFromMe(messages), [JSON.stringify(messages)]);\n\n    const unreadCount = chat?.unreadMessageCount || 0;\n    const isVisible = useSelector(selectVisibilityState);\n\n    const itemKey = useCallback((index: number, data: MessageRepresentation[]) => data[index].id, []);\n\n    const [ processing, setIsProcessing ] = useState(false);\n\n    useEffect(() => {\n        (async () => {\n            if (unreadCount > 0 && isVisible && chat) {\n                if (processing) return;\n                setIsProcessing(true);\n                await apiClient.chats.readAllMessages(chat.id);\n                setIsProcessing(false);\n            }\n        })();\n    }, [unreadCount, isVisible, chat]);\n\n    return (\n        <div className=\"chat-transcript transcript-react-window\" onMouseOver={event => {\n            if (!(event.target instanceof Node)) return;\n            const { messageID, chatItemID } = searchNodeForMessageRelations(event.target);\n\n            if (!messageID) return;\n            store.dispatch(chatItemChanged({ messageID, chatItemID }));\n        }}>\n            <div className=\"message-transcript-container\">\n                <AutoSizer>\n                    {({ height, width }) => (\n                        <DynamicSizeList\n                            height={height}\n                            width={width}\n                            nonce={chat?.id}\n                            itemData={messages}\n                            getID={index => messages[index]?.id || \"-1\"}\n                            itemCount={messages.length}\n                            nearEnd={loadMore}\n                            memoState={{ lastDeliveredFromMe, lastReadFromMe }}\n                            isSame={compareMessageRenderProps}\n                            itemKey={itemKey}\n                            >\n                            {({ ref, index, data }) => (\n                                <Message\n                                    eRef={ref as any}\n                                    message={data[index]}\n                                    nextMessage={data[index - 1]}\n                                    prevMessage={data[index + 1]}\n                                    lastDeliveredFromMe={lastDeliveredFromMe}\n                                    lastReadFromMe={lastReadFromMe}\n                                />\n                            )}\n                        </DynamicSizeList>\n                    )}\n                </AutoSizer>\n            </div>\n            <Composition />\n        </div>\n    );\n}","import { AnyChatItemModel, ChatRepresentation, MessageRepresentation } from \"imcore-ajax-core\";\nimport React, { createContext, PropsWithChildren, useContext, useEffect, useMemo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { matchPath, useLocation } from \"react-router\";\nimport { apiClient, receiveMessages } from \"../../app/connection\";\nimport { selectChats } from \"../../app/reducers/chats\";\nimport { selectMessages } from \"../../app/reducers/messages\";\nimport { selectHoveringOverChatID, selectHoveringOverChatItemID, selectHoveringOverMessageID } from \"../../app/reducers/presence\";\nimport IMMakeLog from \"../../util/log\";\nimport { prepareMessagesForPresentation, TIMESTAMP_ASSOCIATION } from \"../../util/message-presentation\";\n\nconst Log = IMMakeLog(\"ChatTranscriptFoundation\", \"info\");\n\nexport async function reload(chatID: string, before?: string) {\n    const recentMessages = await apiClient.chats.fetchRecentMessages(chatID, {\n        limit: 100,\n        before\n    });\n\n    Log.info(\"Received messages for chat %s from REST\", chatID);\n\n    isDoneLedger[chatID] = recentMessages.length <= 1;\n\n    receiveMessages(recentMessages);\n}\n\nconst loadingLedger: Record<string, boolean | undefined> = {};\nconst isDoneLedger: Record<string, boolean | undefined> = {};\n\nexport function useMessages(chatID?: string, reverse = false, injectTimestamps = true): [MessageRepresentation[], () => Promise<void>] {\n    const allMessages = useSelector(selectMessages);\n\n    const messages = allMessages[chatID || \"\"];\n\n    useEffect(() => {\n        if (!messages && chatID) {\n            Log.info(\"Loading initial messages for chat %s\", chatID);\n            reload(chatID);\n        }\n    }, [messages, chatID]);\n\n    const processedMessages = useMemo(() => prepareMessagesForPresentation(messages, reverse, injectTimestamps), [JSON.stringify(messages)]);\n\n    return [\n        processedMessages,\n        async () => {\n            if (!chatID) return;\n            if (loadingLedger[chatID] || isDoneLedger[chatID]) return;\n            loadingLedger[chatID] = true;\n            const lastMessage = processedMessages[reverse ? (processedMessages.length - 1) : 0];\n            const lastMessageID = lastMessage[TIMESTAMP_ASSOCIATION] as string || lastMessage.id;\n            await reload(chatID, lastMessageID);\n            loadingLedger[chatID] = false;\n        }\n    ] as [MessageRepresentation[], () => Promise<void>];\n}\n\nexport function useCurrentMessages(): [ MessageRepresentation[], () => Promise<void> ] {\n    const { messages, loadMore } = useContext(MessagesContext);\n    \n    return [ messages, loadMore ];\n}\n\nexport const ChatContext = createContext<{\n    chat: ChatRepresentation | null;\n    chatID: string | null;\n}>({\n    chat: null,\n    chatID: null\n});\n\nexport const MessagesContext = createContext<{\n    messages: MessageRepresentation[];\n    loadMore: () => Promise<void>;\n}>({\n    messages: [],\n    loadMore: async () => undefined\n});\n\nexport function useCurrentChat(): ChatRepresentation | null {\n    return useContext(ChatContext).chat;\n}\n\nexport function useCurrentChatID(): string | null {\n    return useContext(ChatContext).chatID;\n}\n\nfunction useResolvedMessage(messageID: string | null, chatID?: string): MessageRepresentation | null {\n    const messages = useSelector(selectMessages);\n    const currentChat = useCurrentChat();\n\n    if (!messageID) return null;\n    if (!chatID) chatID = currentChat?.id;\n    if (!chatID) return null;\n\n    return messages[chatID]?.[messageID] || null;\n}\n\nexport function useHoveredMessage(): MessageRepresentation | null {\n    const hoveredMessage = useSelector(selectHoveringOverMessageID);\n\n    return useResolvedMessage(hoveredMessage);\n}\n\nexport function useHoveredChatItem(): [AnyChatItemModel | null, MessageRepresentation | null] {\n    const hoveredMessage = useHoveredMessage();\n    const hoveredChatItemID = useSelector(selectHoveringOverChatItemID);\n\n    if (!hoveredChatItemID || !hoveredMessage) return [null, hoveredMessage];\n\n    return [hoveredMessage.items.find(item => item.payload.id === hoveredChatItemID) || null, hoveredMessage];\n}\n\nexport function useHoveredChat(): ChatRepresentation | null {\n    const hoveredChat = useSelector(selectHoveringOverChatID);\n    const chats = useSelector(selectChats);\n\n    if (!hoveredChat) return null;\n    return chats[hoveredChat] || null;\n}\n\nexport function CurrentChatProvider({ children }: PropsWithChildren<{}>) {\n    const { pathname } = useLocation();\n    const chatID = useMemo(() => matchPath<{ chatID: string; }>(pathname, {\n        path: \"/chats/:chatID\"\n    })?.params.chatID || null, [pathname]);\n\n    const chats = useSelector(selectChats);\n\n    const chat = chatID ? chats[chatID] : null;\n\n    useEffect(() => {\n        Log.info(\"Chat changed to %s (has chat object: %d)\", chatID, !!chat);\n    }, [chatID]);\n\n    return (\n        <ChatContext.Provider value={{ chat, chatID }}>\n            {children}\n        </ChatContext.Provider>\n    );\n}\n\nexport function CurrentMessagesProvider({ children }: PropsWithChildren<{}>) {\n    const chat = useCurrentChat();\n\n    const [ messages, loadMore ] = useMessages(chat?.id!, true);\n\n    return (\n        <MessagesContext.Provider value={{ messages, loadMore }}>\n            {children}\n        </MessagesContext.Provider>\n    );\n}","import React, { useEffect } from \"react\";\n\nexport default function RecycledElementRenderer<T extends Element, Context extends { id: string }>(renderer: (context: Context) => T, initializer?: (context: Context, el: T) => void, destructor?: (context: Context, el: T) => void) {\n    const cache: Map<string, T> = new Map();\n\n    return function Renderer(context: Context) {\n        if (!cache.has(context.id)) {\n            cache.set(context.id, renderer(context));\n        }\n        \n        const el = cache.get(context.id)!;\n\n        if (initializer) initializer(context, el);\n\n        useEffect(() => () => destructor ? destructor(context, el) : undefined);\n\n        return (\n            <div ref={temp => {\n                if (temp) temp.replaceWith(el);\n            }} />\n        );\n    };\n}\n","import { AcknowledgmentChatItemRepresentation, AcknowledgmentType, AnyChatItemModel, ChatItemAcknowledgableRepresentation, ChatItemType, MessageRepresentation } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { apiClient, receiveMessages } from \"../../../app/connection\";\nimport \"../../../styles/ack-picker/AcknowledgmentPicker.scss\";\nimport { extractAcknowledgments } from \"../items/IMChatItem.Foundation\";\n\nexport interface AcknowledgmentPickerProps {\n    message: MessageRepresentation;\n    chatItem: AnyChatItemModel;\n}\n\nfunction itemIsAcknowledgable(type: AnyChatItemModel[\"type\"], item: AnyChatItemModel[\"payload\"]): item is ChatItemAcknowledgableRepresentation {\n    switch (type) {\n        case ChatItemType.text:\n        case ChatItemType.plugin:\n        case ChatItemType.attachment:\n            return true;\n        default:\n            return false;\n    }\n}\n\ninterface AcknowledgmentButtonProps extends AcknowledgmentPickerProps {\n    ackFromMe: AcknowledgmentChatItemRepresentation | null;\n    name: string;\n    type: AcknowledgmentType;\n}\n\nenum AcknowledgmentName {\n    heart = \"heart\",\n    thumbsUp = \"thumbs-up\",\n    thumbsDown = \"thumbs-down\",\n    emphasize = \"emphasize\",\n    question = \"question\",\n    haha = \"haha-en\"\n}\n\nfunction AcknowledgmentButton({ name, type, ackFromMe, message, chatItem }: AcknowledgmentButtonProps) {\n    const isSelected = ackFromMe?.acknowledgmentType === type;\n\n    return (\n        <div className=\"acknowledgment-button\" attr-acknowledgment-name={name} attr-selected={isSelected.toString()} onClick={async () => {\n            const sendType = isSelected ? type + 1000 : type;\n\n            // store.dispatch(stageAcknowledgmentOverride({\n            //     type: sendType,\n            //     messageID: message.id,\n            //     chatItemID: chatItem.payload.id\n            // }));\n\n            const ackMessage = await apiClient.messages.createAssociatedMessage(chatItem.payload.id, message.id, sendType);\n            receiveMessages([ ackMessage ]);\n        }}>\n\n        </div>\n    );\n}\n\nexport default function AcknowledgmentPicker({ message, chatItem }: AcknowledgmentPickerProps) {\n    const acknowledgments = extractAcknowledgments(chatItem);\n\n    if (!itemIsAcknowledgable(chatItem.type, chatItem.payload)) return null;\n\n    const ackFromMe = acknowledgments[0]?.fromMe ? acknowledgments[0] : null;\n\n    return (\n        <div className=\"acknowledgment-picker\">\n            {([\n                [AcknowledgmentName.heart, AcknowledgmentType.heart],\n                [AcknowledgmentName.thumbsUp, AcknowledgmentType.thumbsup],\n                [AcknowledgmentName.thumbsDown, AcknowledgmentType.thumbsdown],\n                [AcknowledgmentName.haha, AcknowledgmentType.ha],\n                [AcknowledgmentName.emphasize, AcknowledgmentType.exclamation],\n                [AcknowledgmentName.question, AcknowledgmentType.questionmark]\n            ] as [AcknowledgmentName, AcknowledgmentType][]).map(([ name, type ]) => (\n                <AcknowledgmentButton message={message} chatItem={chatItem} ackFromMe={ackFromMe} name={name} type={type} key={name} />\n            ))}\n        </div>\n    );\n}","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport { baseKeymap, splitBlock } from \"prosemirror-commands\";\nimport { keymap } from \"prosemirror-keymap\";\nimport { EditorState, Plugin, Transaction } from \"prosemirror-state\";\nimport \"prosemirror-view/style/prosemirror.css\";\nimport React, { useLayoutEffect, useRef, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { Handle, ProseMirror, useProseMirror } from \"use-prosemirror\";\nimport { apiClient } from \"../../../app/connection\";\nimport { selectShowingDevtools, setShowDevtools } from \"../../../app/reducers/debug\";\nimport { selectVisibilityState } from \"../../../app/reducers/presence\";\nimport { store } from \"../../../app/store\";\nimport \"../../../styles/transcript/Composition.scss\";\nimport { useCurrentChat } from \"../ChatTranscriptFoundation\";\nimport { setEditorView } from \"./MCUtils\";\nimport { makeDragAndDropPlugin } from \"./plugins/DragAndDrop\";\nimport { makePlaceholderPlugin } from \"./plugins/PlaceholderPlugin\";\nimport { IMProseSchema } from \"./schema\";\nimport sendMessage, { documentIsEmpty } from \"./send-message\";\n\nlet currentChat: ChatRepresentation | null = null;\n\nconst IMTypingLedger: Map<string, boolean> = new Map();\n\nasync function fireSendMessage(state: EditorState, dispatch?: ((tr: Transaction<any>) => void) | undefined): Promise<EditorState> {\n    if (!currentChat) return state;\n\n    const chat = currentChat;\n    \n    await sendMessage(state.doc, chat);\n\n    IMTypingLedger.set(chat.id, false);\n\n    const transaction = state.tr.delete(0, state.doc.content.size);\n\n    if (dispatch) dispatch(transaction);\n    else state = state.apply(transaction);\n\n    return state;\n}\n\n/**\n * Main composition view for chat views\n */\nexport default function Composition() {\n    currentChat = useCurrentChat();\n\n    const placeholderPlugin = makePlaceholderPlugin(\"iMessage\");\n    const dragAndDropPlugin = makeDragAndDropPlugin(IMProseSchema);\n    const editorView = useRef(null as Handle | null);\n    const isVisible = useSelector(selectVisibilityState);\n\n    const showingDevtools = useSelector(selectShowingDevtools);\n\n    useLayoutEffect(() => {\n        // synchronize with MCUtils\n        setEditorView(editorView.current);\n    }, [editorView]);\n\n    const [canSend, setCanSend] = useState(false);\n\n    const [state, setState] = useProseMirror({\n        schema: IMProseSchema,\n        plugins: [\n            placeholderPlugin,\n            dragAndDropPlugin,\n            new Plugin({\n                state: {\n                    apply(_, __, ___, newState) {\n                        const isEmpty = documentIsEmpty(newState.doc);\n\n                        setCanSend(!isEmpty);\n\n                        if (!isVisible) return;\n                        if (!currentChat) return;\n\n                        const chatID = currentChat.id;\n\n                        if (isEmpty) {\n                            if (IMTypingLedger.get(chatID)) {\n                                apiClient.chats.setTyping(chatID, false).catch(() => {\n                                    IMTypingLedger.set(chatID, true);\n                                });\n\n                                IMTypingLedger.set(chatID, false);\n                            }\n\n                            return;\n                        }\n\n                        if (IMTypingLedger.get(chatID)) return;\n\n                        apiClient.chats.setTyping(chatID, true).catch(() => {\n                            IMTypingLedger.set(chatID, false);\n                        });\n                        \n                        IMTypingLedger.set(chatID, true);\n\n                        return undefined;\n                    },\n                    init: () => undefined\n                }\n            }),\n            keymap({\n                \"Shift-Enter\": splitBlock,\n                \"Backspace\": baseKeymap[\"Backspace\"],\n                \"Enter\": (state: EditorState, dispatch) => {\n                    fireSendMessage(state, dispatch);\n            \n                    return false;\n                }\n            })\n        ]\n    });\n\n    return (\n        <div className=\"composition\">\n            <div className=\"devtools-trigger\" onClick={() => store.dispatch(setShowDevtools(!showingDevtools))} />\n            <ProseMirror className=\"composition-editor\" state={state} onChange={setState} ref={editorView} />\n            <div attr-can-send={canSend.toString()} className=\"send-composition\" onClick={() => fireSendMessage(state).then(state => setState(state))} />\n        </div>\n    );\n}","import { Node as ProsemirrorNode } from \"prosemirror-model\";\nimport { NodeSelection } from \"prosemirror-state\";\nimport { EditorView } from \"prosemirror-view\";\nimport { Handle } from \"use-prosemirror\";\n\nlet editorViewHandle: Handle | null = null;\n\nfunction editorView() {\n    return editorViewHandle?.view?.dom;\n}\n\nexport function setEditorView(newEditorView: Handle | null) {\n    editorViewHandle = newEditorView;\n}\n\nexport function updateEditorClass(className: string, enabled: boolean) {\n    editorView()?.classList.toggle(className, enabled);\n}\n\nexport function flatDescendants(node: ProsemirrorNode): ProsemirrorNode[] {\n    const descendants: ProsemirrorNode[] = [];\n\n    node.descendants(node => {\n        descendants.push(node);\n        return true;\n    });\n\n    return descendants;\n}\n\nexport function everyDescendant(node: ProsemirrorNode, check: (node: ProsemirrorNode) => boolean): boolean {\n    return flatDescendants(node).every(check);\n}\n\nexport function nodeOnlyContainsText(node: ProsemirrorNode) {\n    return everyDescendant(node, node => node.isText || node.isTextblock);\n}\n\nexport function replaceDOMPRNode(domNode: Node, prNode: ProsemirrorNode, view: EditorView) {\n    const prosePos = view.posAtDOM(domNode, 0);\n\n    view.dispatch(\n        view.state.tr.setSelection(NodeSelection.create(view.state.doc, prosePos))\n                     .deleteSelection()\n                     .insert(prosePos, prNode)\n    );\n}\n\nexport function replaceDOMIDPRNode(domID: string, prNode: ProsemirrorNode, view: EditorView) {\n    replaceDOMPRNode(document.getElementById(domID)!, prNode, view);\n}\n\nexport async function readFile(file: File): Promise<string | ArrayBuffer | null> {\n    const reader = new FileReader();\n\n    const pending = new Promise<string | ArrayBuffer | null>(resolve => reader.addEventListener(\"load\", () => resolve(reader.result)));\n\n    reader.readAsDataURL(file);\n\n    return pending;\n}\n\nexport async function getVideoCover(file: File): Promise<Blob | null> {\n    return new Promise((resolve, reject) => {\n        const player = document.createElement(\"video\");\n        player.setAttribute(\"src\", URL.createObjectURL(file));\n        player.load();\n        player.addEventListener(\"error\", ex => reject(ex.error));\n        player.addEventListener(\"loadedmetadata\", () => {\n            setTimeout(() => {\n                player.currentTime = 0.0;\n            }, 50);\n            player.addEventListener(\"seeked\", () => {\n                const canvas = document.createElement(\"canvas\");\n                canvas.width = player.videoWidth;\n                canvas.height = player.videoHeight;\n\n                const ctx = canvas.getContext(\"2d\")!;\n                ctx.drawImage(player, 0, 0, canvas.width, canvas.height);\n                ctx.canvas.toBlob(blob => resolve(blob), \"image/jpeg\", 0.75);\n            });\n        });\n    });\n}\n\nexport async function getFileImage(file: File): Promise<string | null> {\n    if (file.type.startsWith(\"image\")) return Promise.resolve(URL.createObjectURL(file)) as Promise<string | null>;\n    else if (file.type.startsWith(\"video\")) return getVideoCover(file).then(cover => {\n        if (cover) return URL.createObjectURL(cover);\n        else return null;\n    });\n    else return Promise.resolve(null);\n}","import { AttachmentRepresentation } from \"imcore-ajax-core\";\nimport { DOMOutputSpec, Schema } from \"prosemirror-model\";\nimport { Plugin } from \"prosemirror-state\";\nimport { v4 as makeUUID } from \"uuid\";\nimport { apiClient } from \"../../../../app/connection\";\nimport { getFileImage, replaceDOMIDPRNode } from \"../MCUtils\";\n\nexport const IMFileCache: Map<string, File> = new Map();\nconst IMImageBase64Cache: Map<string, string> = new Map();\nconst IMFileUploadCache: Map<string, AttachmentRepresentation> = new Map();\n\n/**\n * Uploads a file ID, returning an existing attachment if it was already uploaded\n * @param id ID to process\n * @returns promise of an AttachmentRepresentation\n */\nexport async function uploadFileWithID(id: string): Promise<AttachmentRepresentation> {\n    if (IMFileUploadCache.has(id)) return IMFileUploadCache.get(id)!;\n    else {\n        const file = IMFileCache.get(id);\n        if (!file) throw new Error(\"Attempt to upload an unregistered transfer\");\n        const attachment = await apiClient.attachments.create(file, {\n            mime: file.type,\n            filename: file.name\n        });\n        IMFileUploadCache.set(id, attachment);\n        return attachment;\n    }\n}\n\n/**\n * Assembles a ProseMirror node for a File associated with the ID\n * @param id UUID of the file transfer\n * @returns ProseMirror node\n */\nexport function elementForFileWithID(id: string): DOMOutputSpec {\n    const file = IMFileCache.get(id);\n\n    // No file. Abort!\n    if (!file) return [\"p\"];\n\n    const [ type ] = file.type.split(\"/\");\n\n    const isImage = type === \"image\";\n    const isVideo = type === \"video\";\n\n    const baseProps = {\n        \"attachment-id\": id,\n        id,\n        class: \"im-attachment\",\n        \"attachment-type\": type,\n        \"attachment-resolved\": ((isImage || isVideo) ? IMImageBase64Cache.has(id) : true).toString(),\n        name: file.name\n    };\n\n    switch (type) {\n        case \"image\":\n        case \"video\":\n            if (IMImageBase64Cache.has(id)) {\n                // Thumbnail! Yay!\n                const src = IMImageBase64Cache.get(id)!;\n\n                return [\"picture\", baseProps, [\"img\", { src }]];\n            } // otherwise, still processing.\n    }\n\n    return [\"div\", baseProps];\n}\n\nexport function makeDragAndDropPlugin(schema: Schema): Plugin {\n    return new Plugin({\n        props: {\n            handleDOMEvents: {\n                drop(view, event) {\n                    const files = event.dataTransfer?.files as unknown as File[] | null;\n                    const selection = view.state.tr.selection;\n\n                    // no files >:( we've been swindled\n                    if (!files || files.length === 0) return false;\n\n                    event.preventDefault();\n\n                    for (const file of files) {\n                        const id = makeUUID();\n\n                        // store file so it can be uploaded if the message is sent\n                        IMFileCache.set(id, file);\n\n                        // insert node into prosemirror\n                        const node = view.state.tr.insert(selection.$from.pos, schema.nodes.attachment.create({\n                            attachmentID: id\n                        }));\n                        \n                        if (file.type.startsWith(\"image\") || file.type.startsWith(\"video\")) {\n                            // process thumbnail\n\n                            getFileImage(file).then((result: string | null) => {\n                                IMImageBase64Cache.set(id, result as string);\n\n                                // replace the inserted prose node with the processed thumbnail\n                                replaceDOMIDPRNode(id, schema.nodes.attachment.create({\n                                    attachmentID: id,\n                                    resolved: true\n                                }), view);\n                            });\n                        }\n\n                        view.dispatch(node.scrollIntoView());\n                    }\n\n                    return false;\n                }\n            }\n        }\n    });\n}","import { Node as ProsemirrorNode } from \"prosemirror-model\";\nimport { Plugin } from \"prosemirror-state\";\nimport { Decoration, DecorationSet } from \"prosemirror-view\";\n\n/**\n * Presents a placeholder in ProseMirror when it is empty\n * @param service service string to display. currently unused\n * @returns ProseMirror plugin\n */\nexport function makePlaceholderPlugin(service: string): Plugin {\n    return new Plugin({\n        props: {\n            decorations: state => {\n                const decorations: Decoration[] = [];\n\n                const decorate = (node: ProsemirrorNode, pos: number) => {\n                    if (node.type.isBlock && node.childCount === 0) {\n                        decorations.push(\n                            Decoration.node(pos, pos + node.nodeSize, {\n                                class: \"empty-node\",\n                                service: \"iMessage\"\n                            })\n                        );\n                    }\n                };\n\n                state.doc.descendants(decorate);\n\n                return DecorationSet.create(state.doc, decorations);\n            },\n        },\n    });\n}","import { NodeSpec, Schema } from \"prosemirror-model\";\nimport { schema } from \"prosemirror-schema-basic\";\nimport { elementForFileWithID } from \"./plugins/DragAndDrop\";\n\nconst _specNodes = schema.spec.nodes as import(\"orderedmap\")<NodeSpec>;\n\nexport const IMProseSchema = new Schema({\n    nodes: {\n        text: _specNodes.get(\"text\")!,\n        paragraph: _specNodes.get(\"paragraph\")!,\n        doc: _specNodes.get(\"doc\")!,\n        attachment: {\n            inline: true,\n            attrs: {\n                attachmentID: {},\n                resolved: { default: false }\n            },\n            group: \"inline\",\n            draggable: true,\n            parseDOM: [\n                {\n                    tag: \"div[attachment-id]\",\n                    getAttrs: ((node: Element) => {\n                        return {\n                            attachmentID: node.getAttribute(\"attachment-id\")\n                        };\n                    }) as unknown as (node: Node | string) => false | {}\n                }\n            ],\n            toDOM: (({ attrs: { attachmentID } }) => elementForFileWithID(attachmentID))\n        }\n    }\n});","import { ChatRepresentation, MessagePartOptions } from \"imcore-ajax-core\";\nimport { Node as ProsemirrorNode } from \"prosemirror-model\";\nimport { apiClient } from \"../../../app/connection\";\nimport { flatDescendants, nodeOnlyContainsText } from \"./MCUtils\";\nimport { uploadFileWithID } from \"./plugins/DragAndDrop\";\n\nexport function documentIsEmpty(doc: ProsemirrorNode): boolean {\n    const descendants = flatDescendants(doc);\n\n    for (const node of descendants) {\n        if (node.isText && node.nodeSize > 0) return false;\n        else if (node.isTextblock) {\n            if (nodeOnlyContainsText(node) && node.textContent.length > 0) return false;\n        }\n        else if (node.type.name === \"attachment\") return false;\n    }\n\n    return true;\n}\n\n/**\n * Creates and sends a message using the contents of a ProsemirrorNode\n * @param doc node to transform\n * @param chat chat to send the message to\n */\nexport default async function sendMessage(doc: ProsemirrorNode, chat: ChatRepresentation): Promise<void> {\n    if (documentIsEmpty(doc)) return;\n\n    // Parts may resolve asynchronously, so they are stored with their pos so they can be sorted at the end\n    const rawParts: Array<{\n        pos: number;\n        part: MessagePartOptions\n    }> = [];\n\n    // Helper to resolve a part\n    const partWithPos = (pos: number) => rawParts.find(part => part.pos === pos);\n    \n    // Any asynchronous part resolutions\n    const pending: Array<Promise<any>> = [];\n\n    // Maps a node position to an associated chunk. If exists, the text will be appended to the associated chunk. (Think newlines)\n    const textChunks: Record<number, number> = {};\n\n    doc.descendants((node, pos, parent) => {\n        if (node.isText) {\n            rawParts.push({\n                pos,\n                part: {\n                    type: \"text\",\n                    details: node.textContent\n                }\n            });\n            return false;\n        }\n        else if (node.isTextblock) {\n            if (nodeOnlyContainsText(node)) {\n                const { node: nextNode } = parent.childAfter(pos);\n                const nextPos = pos + (nextNode?.nodeSize || 0);\n\n                if (nextNode && nodeOnlyContainsText(nextNode)) {\n                    if (typeof textChunks[pos] === \"number\") {\n                        // map next node to the associated node\n                        textChunks[nextPos] = textChunks[pos];\n                    } else {\n                        // map next node to self\n                        textChunks[nextPos] = pos;\n                    }\n                }\n\n                // partPos is either associated or self\n                const partPos = typeof textChunks[pos] === \"number\" ? textChunks[pos] : pos;\n\n                const associatedPart = partWithPos(partPos);\n\n                if (associatedPart) associatedPart.part.details += `\\n${node.textContent}`;\n                else rawParts.push({\n                    pos,\n                    part: {\n                        type: \"text\",\n                        details: node.textContent\n                    }\n                });\n\n                return false;\n            }\n        }\n        else if (node.type.name === \"attachment\") {\n            const attachmentID = node.attrs.attachmentID;\n            if (!attachmentID) return;\n            \n            pending.push((async () => {\n                // upload the attachment, then store the id\n                const { id } = await uploadFileWithID(attachmentID);\n                rawParts.push({\n                    pos,\n                    part: {\n                        type: \"attachment\",\n                        details: id\n                    }\n                });\n            })());\n\n            return false;\n        }\n    });\n\n    await Promise.all(pending);\n\n    // sort parts by their position, then flatten them to just part\n    const compiled = rawParts.sort((p1, p2) => p1.pos - p2.pos).map(({ part }) => part);\n\n    await apiClient.chats.sendMessage(chat.id, {\n        parts: compiled\n    });\n}","import createRegex from \"emoji-regex/RGI_Emoji\";\nimport { AcknowledgmentChatItemRepresentation, AnyChatItemModel, ChatItemType } from \"imcore-ajax-core\";\n\nexport function extractAcknowledgments(item: AnyChatItemModel): AcknowledgmentChatItemRepresentation[] {\n    switch (item.type) {\n        case ChatItemType.text:\n        case ChatItemType.attachment:\n        case ChatItemType.plugin:\n            if (!item.payload.acknowledgments) return [];\n\n            const acknowledgments: AcknowledgmentChatItemRepresentation[] = [];\n\n            for (const acknowledgment of item.payload.acknowledgments) {\n                if (acknowledgment.acknowledgmentType < 3000) acknowledgments.push(acknowledgment);\n            }\n\n            return acknowledgments.sort((ack1, ack2) => ack1.fromMe ? -1 : (ack2.time - ack1.time));\n        default:\n            return [];\n    }\n}\n\nfunction emojiCount(str: string) {\n    const joiner = \"\\u{200D}\";\n    const split = str.split(joiner);\n    let count = 0;\n    \n    for(const s of split){\n        //removing the variation selectors\n        const num = Array.from(s.split(/[\\ufe00-\\ufe0f]/).join(\"\")).length;\n        count += num;\n    }\n    \n    //assuming the joiners are used appropriately\n    return count / split.length;\n}\n\nconst regex = createRegex();\n\nfunction IMTextChatItemIsJumbo(text: string): boolean {\n    if (emojiCount(text) > 3) return false;\n\n    return text.replace(/\\s/g, \"\").replace(regex, \"\").length === 0;\n}\n\nexport function IMItemIsJumbo(item: AnyChatItemModel): boolean {\n    return item.type === ChatItemType.text && !item.payload.subject && IMTextChatItemIsJumbo(item.payload.text);\n}","import { AnyChatItemModel, ChatItemType, ChatRepresentation, MessageRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithChildren, useMemo } from \"react\";\nimport \"../../../styles/transcript/items/IMChatItem.scss\";\nimport IMAttachmentChatItem from \"./chat/IMAttachmentChatItem\";\nimport IMPluginChatItem from \"./chat/IMPluginChatItem\";\nimport IMTextChatItem from \"./chat/IMTextChatItem\";\nimport IMTypingChatItem from \"./chat/IMTypingChatItem\";\nimport { extractAcknowledgments, IMItemIsJumbo } from \"./IMChatItem.Foundation\";\nimport { IMItemRenderingContext } from \"./Message\";\n\ntype ChatItemComponentRenderer = ((opts: {\n    item: AnyChatItemModel[\"payload\"],\n    message: MessageRepresentation,\n    chat: ChatRepresentation,\n    changed: IMItemRenderingContext[\"changed\"],\n    index: number\n}) => JSX.Element) | null;\n\nfunction chatItemComponentForItem(item: AnyChatItemModel): ChatItemComponentRenderer {\n    switch (item.type) {\n        case ChatItemType.text:\n            return IMTextChatItem as ChatItemComponentRenderer;\n        case ChatItemType.attachment:\n            return IMAttachmentChatItem as ChatItemComponentRenderer;\n        case ChatItemType.plugin:\n            return IMPluginChatItem as ChatItemComponentRenderer;\n        case ChatItemType.typing:\n            return IMTypingChatItem as ChatItemComponentRenderer;\n        case ChatItemType.sticker:\n        default:\n            return null;\n    }\n}\n\nexport function isChatItem(item: AnyChatItemModel) {\n    return !!chatItemComponentForItem(item);\n}\n\nexport default function IMChatItem({ item, message, chat, changed, index }: PropsWithChildren<IMItemRenderingContext>) {\n    if (item.type === ChatItemType.plugin && item.payload.fallback) item = item.payload.fallback;\n    const Component = chatItemComponentForItem(item) as ChatItemComponentRenderer;\n\n    const acknowledgments = extractAcknowledgments(item);\n    const isJumbo = useMemo(() => IMItemIsJumbo(item), [item]);\n\n    if (!Component) return null;\n\n    return (\n        <>\n            <div className={`chat-item-container${isJumbo ? \" chat-item-jumbo\" : \"\"}`} data-has-acknowledgments={(acknowledgments.length > 0).toString()} attr-chat-item-id={item.payload.id}>\n                <div className=\"chat-item\" data-item-type={item.type} attr-from-me={message.fromMe.toString()}>\n                    <div className=\"item-inner\">\n                        <Component index={index} item={item.payload} message={message} chat={chat} changed={changed} key={item.payload.id} />\n                    </div>\n                </div>\n\n                {\n                    acknowledgments.length ? (\n                        <div className=\"acknowledgment-overlay\" data-acknowledgment-count={acknowledgments.length} data-acknowledgment-from-me={acknowledgments.some(a => a.fromMe).toString()}>\n                            {acknowledgments.slice(0, 3).map(ack => (\n                                <div className=\"acknowledgment-item\" key={ack.id} data-ack-type={ack.acknowledgmentType} data-from-me={ack.fromMe} />\n                            ))}\n                        </div>\n                    ) : null\n                }\n            </div>\n        </>\n    );\n}","import { AnyChatItemModel, ChatItemType, ChatRepresentation, MessageRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithChildren } from \"react\";\nimport \"../../../styles/transcript/items/IMTranscriptItem.scss\";\nimport { useFormattedTimestamp } from \"../../../util/receipt-formatting\";\nimport { IMItemRenderingContext } from \"./Message\";\nimport IMDateSeparatorItem from \"./transcript/IMDateSeparatorItem\";\nimport IMGroupTitleChangeItem from \"./transcript/IMGroupTitleChangeItem\";\nimport IMParticipantChangeItem from \"./transcript/IMParticipantChangeItem\";\n\nexport const DATE_SEPARATOR_TYPE: ChatItemType = Symbol(\"DATE_SEPARATOR\") as unknown as ChatItemType;\n\nconst transcriptTypes = [\n    ChatItemType.date,\n    ChatItemType.participantChange,\n    ChatItemType.groupAction,\n    ChatItemType.groupTitle,\n    DATE_SEPARATOR_TYPE\n];\n\nfunction itemIsTranscriptLike(item: AnyChatItemModel) {\n    return transcriptTypes.includes(item.type);\n}\n\nfunction componentForItem(item: AnyChatItemModel) {\n    switch (item.type) {\n        case ChatItemType.groupTitle:\n            return IMGroupTitleChangeItem;\n        case ChatItemType.participantChange:\n            return IMParticipantChangeItem;\n        case DATE_SEPARATOR_TYPE:\n            return IMDateSeparatorItem;\n        default:\n            return null;\n    }\n}\n\nexport function isTranscriptItem(item: AnyChatItemModel) {\n    return itemIsTranscriptLike(item) && componentForItem(item) !== null;\n}\n\nexport default function IMTranscriptItem({ item, message, chat, changed }: PropsWithChildren<IMItemRenderingContext>) {\n    const Component = componentForItem(item) as ((opts: {\n        item: AnyChatItemModel[\"payload\"],\n        message: MessageRepresentation,\n        chat: ChatRepresentation,\n        changed: IMItemRenderingContext[\"changed\"]\n    }) => JSX.Element) | null;\n\n    const { date, time } = useFormattedTimestamp(message.time) || {};\n\n    if (!Component) return null;\n\n    return (\n        <div className=\"transcript-item-container\">\n            <div className=\"transcript-label\">{date} <span className=\"transcript-label-value\">{time}</span></div>\n            <Component item={item.payload} message={message} chat={chat} key={item.payload.id} changed={changed} />\n        </div>\n    );\n}","import { ChatItemType, ChatRepresentation, MessageRepresentation } from \"imcore-ajax-core\";\nimport { ChatStyle } from \"../../chat/ChatBubble\";\nimport { isChatItem } from \"./IMChatItem\";\nimport { extractAcknowledgments } from \"./IMChatItem.Foundation\";\n\nexport interface MessageAnalysis {\n    beginningContiguous: boolean;\n    endingContiguous: boolean;\n    showImage: boolean;\n    showName: boolean;\n}\n\nfunction allItemsAreChatItems({ items }: MessageRepresentation) {\n    for (const item of items) {\n        if (!isChatItem(item)) return false;\n    }\n\n    return true;\n}\n\nexport function itemsAreShallowEqual(message1: MessageRepresentation | undefined, message2: MessageRepresentation | undefined) {\n    if ((!message1 && !message2) || !(message1 && message2)) return false;\n\n    const { items: items1 } = message1, { items: items2 } = message2;\n\n    if (items1.length !== items2.length) return false;\n    // if (message1.flags !== message2.flags) return false;\n    // if (message1.time !== message2.time) return false;\n    if (message1.timeDelivered !== message2.timeDelivered) return false;\n    if (message1.timeRead !== message2.timeRead) return false;\n    if (message1.isDelivered !== message2.isDelivered) return false;\n\n    for (let i = 0; i < items1.length; i++)  {\n        const item1 = items1[i], item2 = items2[i];\n\n        if (item1.type !== item2.type) return false;\n\n        switch (item1.type) {\n            /* eslint-disable */\n            case ChatItemType.plugin:\n                if (item1.payload && item2.payload) return false;\n            case ChatItemType.text:\n            case ChatItemType.attachment:\n                if (!item1.payload.acknowledgments && !(item2 as typeof item1).payload.acknowledgments) continue;\n                if (!item1.payload.acknowledgments || !(item2 as typeof item1).payload.acknowledgments) return false;\n                const { acknowledgments: ack1 } = item1.payload, { acknowledgments: ack2 } = (item2 as typeof item1).payload\n                if (ack1.length !== ack2!.length) return false;\n                for (let i = 0; i < ack1.length; i++) {\n                    const innerAck1 = ack1[i], innerAck2 = ack2![i];\n                    if (innerAck1.id !== innerAck2.id) return false;\n                    if (innerAck1.sender !== innerAck2.sender) return false;\n                    if (innerAck1.acknowledgmentType !== innerAck2.acknowledgmentType) return false;\n                    if (innerAck1.associatedID !== innerAck2.associatedID) return false;\n                }\n            /* eslint-enable */\n        }\n    }\n\n    return true;\n}\n\nexport function messagesAreContiguous(message: MessageRepresentation, nextMessage: MessageRepresentation) {\n    if (message.sender !== nextMessage.sender) return false;\n    if (!allItemsAreChatItems(message) || !allItemsAreChatItems(nextMessage)) return false;\n    \n    if (Math.abs(message.time - nextMessage.time) < (1000 * 60)) {\n        for (const item of nextMessage.items) {\n            if (extractAcknowledgments(item).length > 0) return false;\n        }\n\n        return true;\n    } else return false;\n}\n\nexport interface MessageAnalysisRequest {\n    message: MessageRepresentation;\n    chat: ChatRepresentation;\n    nextMessage?: MessageRepresentation;\n    prevMessage?: MessageRepresentation;\n}\n\nexport function analyzeMessage({ message, chat, nextMessage, prevMessage }: MessageAnalysisRequest): MessageAnalysis {\n    const beginningContiguous = prevMessage ? messagesAreContiguous(prevMessage, message) : false;\n    const endingContiguous = nextMessage ? messagesAreContiguous(message, nextMessage) : false;\n\n    return {\n        beginningContiguous,\n        endingContiguous,\n        showImage: chat?.style === ChatStyle.group && !message.fromMe && !endingContiguous,\n        showName: chat?.style === ChatStyle.group && !message.fromMe && !beginningContiguous && (prevMessage ? prevMessage.sender !== message.sender : true)\n    };\n}","import { AnyChatItemModel, ChatRepresentation, MessageRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithRef, useMemo } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectHandleIDToContact } from \"../../../app/reducers/contacts\";\nimport { formatPhoneNumber } from \"../../../hooks/useFormattedHandles\";\nimport \"../../../styles/transcript/items/Message.scss\";\nimport { ChatStyle } from \"../../chat/ChatBubble\";\nimport CNContactBubble from \"../../contacts/CNContactBubble\";\nimport { useCurrentChat } from \"../ChatTranscriptFoundation\";\nimport IMChatItem, { isChatItem } from \"./IMChatItem\";\nimport IMTranscriptItem, { isTranscriptItem } from \"./IMTranscriptItem\";\nimport { analyzeMessage } from \"./Message.foundation\";\nimport MessageReceiptController from \"./MessageReceiptController\";\n\nexport interface IMItemRenderingContext<Item = AnyChatItemModel> {\n    item: Item\n    message: MessageRepresentation\n    chat: ChatRepresentation\n    index: number\n    changed: () => any\n}\n\nfunction componentForItem(item: AnyChatItemModel) {\n    if (isTranscriptItem(item)) return IMTranscriptItem;\n    else if (isChatItem(item)) return IMChatItem;\n    else return null;\n}\n\nexport function messageIsEmpty(message: MessageRepresentation) {\n    for (const item of message.items) {\n        if (componentForItem(item)) return false;\n    }\n\n    return true;\n}\n\nfunction useContact(message: MessageRepresentation) {\n    return useSelector(selectHandleIDToContact)[message.sender || \"\"] || null;\n}\n\nfunction useMessageSenderName(message: MessageRepresentation) {\n    const contact = useContact(message);\n\n    if (contact?.fullName) return contact.fullName;\n    else return formatPhoneNumber(message.sender || \"<< system >>\");\n}\n\nfunction Message({ eRef, message, nextMessage, prevMessage, lastDeliveredFromMe, lastReadFromMe, changed, style }: PropsWithRef<{\n    message: MessageRepresentation,\n    nextMessage?: MessageRepresentation,\n    prevMessage?: MessageRepresentation,\n    lastDeliveredFromMe?: string | null,\n    lastReadFromMe?: string | null,\n    style?: any,\n    changed?: () => any,\n    eRef?: (elm: Element) => any\n}>) {\n    const chat = useCurrentChat()!;\n    const messageSenderContact = useContact(message);\n    \n    const { beginningContiguous, endingContiguous, showImage, showName } = useMemo(() => analyzeMessage({\n        message,\n        nextMessage,\n        chat,\n        prevMessage\n    }), [JSON.stringify(message), JSON.stringify(nextMessage), JSON.stringify(prevMessage), chat]);\n\n    changed = changed || (() => undefined);\n\n    const items = message.items.map((item, index) => {\n        const Component = componentForItem(item);\n\n        if (!Component) return null;\n        \n        return <Component key={item.payload.id} index={index} changed={changed!} item={item} message={message} chat={chat} />;\n    }).filter(item => item);\n\n    const messageIsTranscriptMessage = message.items.every(isTranscriptItem);\n    const nextIsTranscript = nextMessage?.items.every(isTranscriptItem) || false;\n    const prevIsTranscript = prevMessage?.items.every(isTranscriptItem) || false;\n\n    const senderName = useMessageSenderName(message);\n\n    const showReceipt = chat.style === ChatStyle.solo && message.fromMe && (lastDeliveredFromMe === message.id || lastReadFromMe === message.id);\n\n    return (\n        items.length ? (\n            <div className=\"message-container\" ref={eRef as unknown as React.ClassAttributes<HTMLDivElement>[\"ref\"]} style={style}>\n                <div className=\"message\" attr-message-id={message.id} attr-prev-contiguous={beginningContiguous.toString()} attr-next-contiguous={endingContiguous.toString()} attr-next-transcript-contiguous={(messageIsTranscriptMessage && nextIsTranscript).toString()} attr-prev-transcript-contiguous={(messageIsTranscriptMessage && prevIsTranscript).toString()} attr-from-me={message.fromMe.toString()} attr-service={message.service}>\n                    {\n                        messageIsTranscriptMessage ? items : <>\n                            {\n                                (chat.style === ChatStyle.group && !message.fromMe) ? (\n                                    <div className=\"buddy-picture-track\">\n                                        {showImage ? (\n                                            <CNContactBubble contact={messageSenderContact} />\n                                        ) : null}\n                                    </div>\n                                ) : null\n                            }\n                            <div className=\"items-track\">\n                                { showName ? (\n                                    <div className=\"buddy-name\">{senderName}</div>\n                                ) : null}\n                                {items}\n                                {\n                                    message.fromMe ? (\n                                        <MessageReceiptController showReceipt={showReceipt} timeRead={message.timeRead} id={message.id}></MessageReceiptController>\n                                    ) : null\n                                }\n                            </div>\n                        </>\n                    }\n                </div>\n            </div>\n        ) : null\n    );\n}\n\nexport default Message;","import React, { useLayoutEffect, useRef, useState } from \"react\";\nimport { useFormattedReceipt } from \"../../../util/receipt-formatting\";\n\nconst readReceiptTransitionManager: Map<string, boolean> = new Map();\n\nfunction useEffectAfterFirstRun(effect: React.EffectCallback, deps?: React.DependencyList | undefined) {\n    const isFirstRun = useRef(true);\n\n    return useLayoutEffect(() => {\n        if (isFirstRun.current) {\n            isFirstRun.current = false;\n            return;\n        }\n\n        effect();\n    }, deps);\n}\n\nexport default function MessageReceiptController({ showReceipt, timeRead, id }: { showReceipt: boolean, timeRead: number, id: string }) {\n    const formattedReceipt = useFormattedReceipt(showReceipt ? timeRead : null);\n\n    const [isComplete, setIsComplete] = useState(true);\n    const [isTransitioning, setIsTransitioning] = useState(false);\n    const [isAppearing, setIsAppearing] = useState(false);\n    const [isDisappearing, setIsDisappearing] = useState(false);\n\n    if (!readReceiptTransitionManager.has(id)) readReceiptTransitionManager.set(id, showReceipt);\n    else if (!isTransitioning && readReceiptTransitionManager.get(id) !== showReceipt) {\n        setIsAppearing(showReceipt);\n        setIsDisappearing(!showReceipt);\n        setIsTransitioning(true);\n        setIsComplete(false);\n    }\n\n    useEffectAfterFirstRun(() => {\n        if (isComplete) {\n            readReceiptTransitionManager.set(id, showReceipt);\n            setIsTransitioning(false);\n            setIsAppearing(false);\n            setIsDisappearing(false);\n        }\n    }, [isComplete]);\n\n    return (\n        showReceipt || isTransitioning ? (\n            <span\n                className=\"transcript-label message-receipt\"\n                attr-is-transitioning={isTransitioning.toString()}\n                attr-is-appearing={isAppearing.toString()}\n                attr-is-disappearing={isDisappearing.toString()}\n                onAnimationEnd={() => setIsComplete(true)}\n                >\n                {timeRead ? (\n                    <>Read <span className=\"transcript-label-value\">{formattedReceipt}</span></>\n                ) : \"Delivered\"}\n            </span>\n        ) : null\n    );\n}","import { AttachmentChatItemRepresentation, AttachmentRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\nimport { apiClient } from \"../../../../app/connection\";\nimport RecycledElementRenderer from \"../../Recycler\";\nimport { IMItemRenderingContext } from \"../Message\";\n\ninterface IMAttachmentChatItemRenderContext extends IMItemRenderingContext<Omit<AttachmentChatItemRepresentation, \"metadata\"> & { metadata?: CanaryAttachmentRepresentation }> {}\n\ninterface Size {\n    width: number;\n    height: number;\n}\n\ninterface CanaryAttachmentRepresentation extends AttachmentRepresentation {\n    size?: Size;\n}\n\nenum IMAttachmentRenderingFormat {\n    image = \"image\",\n    video = \"video\",\n    file = \"file\"\n}\n\nfunction ERComputeRenderingFormat({ metadata }: AttachmentChatItemRepresentation) {\n    switch (metadata?.mime?.substring(0, 5) || \"\") {\n        case \"image\":\n            return IMAttachmentRenderingFormat.image;\n        case \"video\":\n            return IMAttachmentRenderingFormat.video;\n        default:\n            return IMAttachmentRenderingFormat.file;\n    }\n}\n\ninterface AttachmentRenderingContext {\n    id: string;\n    url: string;\n    changed: () => any;\n    width?: number;\n    height?: number;\n    description?: string;\n}\n\nconst IMImageAttachmentRenderer = RecycledElementRenderer(({ width, height, url, description }: AttachmentRenderingContext) => {\n    const element = document.createElement(\"img\");\n    element.setAttribute(\"width\", width?.toString() || \"100%\");\n    element.height = height!;\n    element.draggable = true;\n    element.src = url;\n    element.alt = description!;\n\n    return element;\n}, ({ changed }, el) => {\n    el.addEventListener(\"load\", changed);\n}, ({ changed }, el) => {\n    el.removeEventListener(\"load\", changed);\n});\n\nconst IMVideoAttachmentRenderer = RecycledElementRenderer(({ width, height, url }: AttachmentRenderingContext) => {\n    const element = document.createElement(\"video\");\n    element.width = width!;\n    element.height = height!;\n    element.preload = \"auto\";\n    element.draggable = true;\n    element.src = url;\n    element.controls = true;\n\n    return element;\n}, ({ changed }, el) => {\n    el.addEventListener(\"loadedmetadata\", changed);\n}, ({ changed }, el) => {\n    el.removeEventListener(\"loadedmetadata\", changed);\n});\n\nfunction IMRenderingImplementation(item: IMAttachmentChatItemRenderContext[\"item\"]) {\n    switch (ERComputeRenderingFormat(item)) {\n        case IMAttachmentRenderingFormat.image:\n            return IMImageAttachmentRenderer;\n        case IMAttachmentRenderingFormat.video:\n            return IMVideoAttachmentRenderer;\n        default:\n            return null;\n    }\n}\n\nfunction IMAttachmentChatItem({ item, message, changed }: PropsWithoutRef<IMAttachmentChatItemRenderContext>) {\n    const url = apiClient.attachmentURL(item.transferID);\n    const { width, height } = item.metadata?.size || {};\n\n    const RenderingImplementation = IMRenderingImplementation(item);\n\n    if (!RenderingImplementation) return null;\n\n    return (\n        <RenderingImplementation id={item.id} width={width} height={height} url={url} changed={changed} description={message.description} />\n    );\n}\n\nexport default React.memo(IMAttachmentChatItem, ({ item: prevItem }, { item: newItem }) => JSON.stringify(prevItem) === JSON.stringify(newItem));","import { PluginChatItemRepresentation } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\nimport IMMakeLog from \"../../../../util/log\";\nimport { IMItemRenderingContext } from \"../Message\";\nimport LPBalloon from \"./plugin-renderers/LPBalloon\";\nimport MSMessageExtensionBalloonPlugin from \"./plugin-renderers/MSMessageExtensionBalloonPlugin\";\n\ninterface IMPluginChatItemRenderContext extends IMItemRenderingContext<PluginChatItemRepresentation> {\n}\n\nconst Log = IMMakeLog(\"IMPluginChatItem\");\n\nfunction componentForItem(item: PluginChatItemRepresentation): null | ((ctx: Partial<PluginChatItemRepresentation> & { changed: () => any }) => JSX.Element) {\n    switch (item.bundleID.split(\":\")[0]) {\n        case \"com.apple.messages.URLBalloonProvider\":\n            if (!item.richLink) return null;\n            return LPBalloon as unknown as ReturnType<typeof componentForItem>;\n        case \"com.apple.messages.MSMessageExtensionBalloonPlugin\":\n            return MSMessageExtensionBalloonPlugin as unknown as ReturnType<typeof componentForItem>;\n        default:\n            Log.warn(\"No implementation available for item with bundleID\", item.bundleID);\n            return null;\n    }\n}\n\nfunction IMPluginChatItem({ item, ...ctx }: PropsWithoutRef<IMPluginChatItemRenderContext>) {\n    const Component = componentForItem(item);\n\n    if (!Component) return null;\n\n    return (\n        <Component changed={ctx.changed} {...item} />\n    );\n}\n\nexport default React.memo(IMPluginChatItem, ({ item: prevItem }, { item: newItem }) => JSON.stringify(prevItem) === JSON.stringify(newItem));","import { TextChatItemRepresentation, TextPart, TextPartAttributeType, TextPartType } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\nimport IMMakeLog from \"../../../../util/log\";\nimport { IMItemRenderingContext } from \"../Message\";\n\nconst Log = IMMakeLog(\"IMTextChatItem\");\n\ninterface IMTextChatItemRenderContext extends IMItemRenderingContext<TextChatItemRepresentation> {}\n\ninterface IMTextPartRenderContext extends IMTextChatItemRenderContext {\n    part: TextPart;\n}\n\ntype IMTextPartProps = PropsWithoutRef<IMTextPartRenderContext>\n\nenum IMTextPartFormattingDirective {\n    bold = \"text-part-bold\",\n    underline = \"text-part-underline\"\n}\n\nfunction ERExtractFormattingDirectivesForIMTextPart(part: TextPart): IMTextPartFormattingDirective[] {\n    const directives: Set<IMTextPartFormattingDirective> = new Set();\n\n    if (part.attributes) {\n        for (const attr of part.attributes) {\n            switch (attr.key) {\n                case TextPartAttributeType.bold:\n                case TextPartAttributeType.mention:\n                    directives.add(IMTextPartFormattingDirective.bold);\n                    break;\n                case TextPartAttributeType.writingDirection:\n                    break;\n                default:\n                    Log.warn(\"No formatting implementation available for TextPartAttributeType\", attr.key);\n            }\n        }\n    }\n\n    if (part.type === TextPartType.calendar) directives.add(IMTextPartFormattingDirective.underline);\n\n    return Array.from(directives);\n}\n\nfunction IMTextPartAttributeFormatter({ part, directives: additionalDirectives = [] }: IMTextPartProps & { directives?: IMTextPartFormattingDirective[] }) {\n    const directives = ERExtractFormattingDirectivesForIMTextPart(part).concat(additionalDirectives);\n\n    if (!directives.length) {\n        return (\n            <React.Fragment>\n                {part.string}\n            </React.Fragment>\n        );\n    }\n\n    return (\n        <span className={directives.join(\" \")}>{part.string}</span>\n    );\n}\n\nfunction IMTextLinkPart(ctx: IMTextPartProps) {\n    return (\n        <a href={ctx.part.data}>\n            <IMTextPartAttributeFormatter {...ctx} />\n        </a>\n    );\n}\n\nfunction componentForPart(part: TextPart) {\n    switch (part.type) {\n        case TextPartType.link:\n            return IMTextLinkPart;\n        case TextPartType.text:\n        case TextPartType.calendar:\n            return IMTextPartAttributeFormatter;\n        default:\n            Log.warn(\"No implementation available for text part with type\", part.type);\n            return IMTextPartAttributeFormatter;\n    }\n}\n\nfunction IMTextChatItem(ctx: PropsWithoutRef<IMTextChatItemRenderContext>) {\n    return (\n        <React.Fragment>\n            {ctx.item.subject ? (\n                <React.Fragment>\n                    <IMTextPartAttributeFormatter {...ctx} part={{\n                        type: TextPartType.text,\n                        string: ctx.item.subject\n                    }} directives={[IMTextPartFormattingDirective.bold]} />\n                    <br />\n                </React.Fragment>\n            ) : null}\n            {ctx.item.parts.map((part, index) => {\n                const Component = componentForPart(part);\n\n                if (!Component) return null;\n                \n                return <Component key={`${ctx.item.id}-${index}`} part={part} {...ctx} />;\n            })}\n        </React.Fragment>\n    );\n}\n\nexport default React.memo(IMTextChatItem, ({ item: prevItem }, { item: newItem }) => JSON.stringify(prevItem) === JSON.stringify(newItem));","import React from \"react\";\n\nexport default React.memo(function IMTypingChatItem() {\n    return (\n        <div className=\"typing-item\">\n            <div className=\"typing-dot-1\" />\n            <div className=\"typing-dot-2\" />\n            <div className=\"typing-dot-3\" />\n        </div>\n    );\n});","import { AttachmentRepresentation, Color, RichLink } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\nimport LPCaptionBar from \"./lp-support/LPCaptionBar\";\nimport LPMedia from \"./lp-support/LPMedia\";\n\nexport type LPRenderingContext = PropsWithoutRef<{\n    attachments: AttachmentRepresentation[];\n    id: string;\n}>;\n\ninterface LPBalloonRenderingContext extends LPRenderingContext {\n    richLink: RichLink;\n    changed: () => any;\n    className?: string;\n}\n\nfunction makeRGBA(color: Color | undefined) {\n    if (!color) return undefined;\n    return `rgba(${color.red},${color.green},${color.blue},${color.alpha})`;\n}\n\nexport default function LPBalloon({ className, richLink, changed, attachments, id }: LPBalloonRenderingContext) {\n    const backgroundRGBA = makeRGBA(richLink.backgroundColor);\n\n    const Element = richLink.url ? \"a\" : \"div\";\n\n    return (\n        <Element href={richLink.url} target=\"_blank\" className={className ? `lp-balloon ${className}` : \"lp-balloon\"} style={{\n            background: backgroundRGBA\n        }}>\n            <LPMedia id={id} changed={changed} video={richLink.video} image={richLink.image} audio={richLink.audio} topCaptionBar={richLink.mediaTopCaptionBar} bottomCaptionBar={richLink.mediaBottomCpationBar} attachments={attachments} />\n            {\n                richLink.quotedText ? (\n                    <div className=\"lp-quoted-text\">{ richLink.quotedText }</div>\n                ) : null\n            }\n            {\n                richLink.captionBar ? (\n                    <LPCaptionBar id={id} captionBar={richLink.captionBar} attachments={attachments} />\n                ) : null\n            }\n        </Element>\n    );\n}","import { AttachmentRepresentation, MessagesExtension, MessagesExtensionLayoutInfo, RichLink, RichLinkCaptionBar, RichLinkCpationText } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\nimport LPBalloon from \"./LPBalloon\";\n\ninterface MSMessageExtensionRenderingContext extends PropsWithoutRef<{}> {\n    extension?: MessagesExtension;\n    attachments: AttachmentRepresentation[];\n    id: string;\n    changed: () => void;\n}\n\nfunction makeText(text: string): RichLinkCpationText {\n    return {\n        text,\n        textScale: 1\n    };\n}\n\nfunction generateCaptionBar({ caption, subcaption, secondarySubcaption, tertiarySubcaption }: MessagesExtensionLayoutInfo): RichLinkCaptionBar | undefined {\n    if (!caption && !subcaption && !secondarySubcaption && !tertiarySubcaption) return;\n\n    return {\n        top: (caption || secondarySubcaption) ? {\n            leading: caption ? makeText(caption) : undefined,\n            trailing: secondarySubcaption ? makeText(secondarySubcaption) : undefined\n        } : undefined,\n        bottom: (subcaption || tertiarySubcaption) ? {\n            leading: subcaption ? makeText(subcaption) : undefined,\n            trailing: tertiarySubcaption ? makeText(tertiarySubcaption) : undefined\n        } : undefined\n    };\n}\n\nfunction generateMediaBottomCaptionBar({ imageTitle, imageSubtitle }: MessagesExtensionLayoutInfo): RichLinkCaptionBar | undefined {\n    if (!imageTitle && !imageSubtitle) return;\n\n    return {\n        top: imageTitle ? {\n            leading: makeText(imageTitle)\n        } : undefined,\n        bottom: imageSubtitle ? {\n            leading: makeText(imageSubtitle)\n        } : undefined\n    };\n}\n\nfunction generateMediaTopCaptionBar(appIcon: string | undefined): (RichLinkCaptionBar & { leadingIcon: { src: string } }) | undefined {\n    if (!appIcon) return;\n\n    return {\n        leadingIcon: {\n            type: 99,\n            src: appIcon\n        }\n    };\n}\n\nfunction generateRichLink({ layoutInfo, appName, appIcon }: MessagesExtension, attachments: AttachmentRepresentation[]): RichLink {\n    return {\n        captionBar: generateCaptionBar(layoutInfo || {}),\n        mediaBottomCpationBar: generateMediaBottomCaptionBar(layoutInfo || {}),\n        mediaTopCaptionBar: generateMediaTopCaptionBar(appIcon),\n        image: attachments[0] ? {\n            attachmentIndex: 0,\n            type: 0\n        } : undefined\n    };\n}\n\nexport default function MSMessageExtensionBalloonPlugin({ extension, attachments, changed, id }: MSMessageExtensionRenderingContext) {\n    if (!extension) return null;\n\n    return <LPBalloon className=\"lp-message-extension-compat\" id={id} richLink={generateRichLink(extension, attachments)} attachments={attachments} changed={changed} />;\n}","import RecycledElementRenderer from \"../../../../Recycler\";\n\nexport interface LPAssetRenderingConext {\n    videoURL?: string | null;\n    imageURL?: string | null;\n    changed: () => any;\n    id: string;\n}\n\nconst LPAssetRenderer = RecycledElementRenderer<HTMLElement, LPAssetRenderingConext>(({ videoURL, imageURL, changed }) => {\n    if (videoURL) {\n        const element = document.createElement(\"video\");\n        element.className = \"lp-video\";\n        element.src = videoURL;\n        if (imageURL) element.poster = imageURL;\n        element.controls = true;\n\n        return element;\n    } else if (imageURL) {\n        const element = document.createElement(\"img\");\n        element.alt = \"Rich Link Banner\";\n        element.src = imageURL;\n\n        return element;\n    } else return document.createElement(\"div\");\n}, ({ changed }, el) => {\n    el.addEventListener(\"loadedmetadata\", changed);\n    el.addEventListener(\"load\", changed);\n}, ({ changed }, el) => {\n    el.removeEventListener(\"loadedmetadata\", changed);\n    el.removeEventListener(\"load\", changed);\n});\n\nexport default LPAssetRenderer;","import { RichLinkCaptionBar } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { LPRenderingContext } from \"../LPBalloon\";\nimport LPCaptionIcon from \"./LPCaptionIcon\";\nimport LPCaptionSection from \"./LPCaptionSection\";\n\nexport interface LPCaptionBarRenderingContext extends LPRenderingContext {\n    captionBar: RichLinkCaptionBar;\n}\n\nexport default function LPCaptionBar({ id, captionBar: { aboveTop, top, bottom, belowBottom, leadingIcon, trailingIcon }, attachments }: LPCaptionBarRenderingContext) {\n    if (!aboveTop && !top && !bottom && !belowBottom && !leadingIcon && !trailingIcon) return null;\n\n    return (\n        <div className=\"lp-caption-bar\">\n            <LPCaptionIcon id={id} icon={leadingIcon} attachments={attachments} position=\"left\" />\n            {\n                (aboveTop || top || bottom || belowBottom) ? (\n                    <div className=\"lp-text-stack\">\n                        <LPCaptionSection position=\"aboveTop\" section={aboveTop} />\n                        <LPCaptionSection position=\"top\" section={top} />\n                        <LPCaptionSection position=\"bottom\" section={bottom} />\n                        <LPCaptionSection position=\"belowBottom\" section={belowBottom} />\n                    </div>\n                ) : null\n            }\n            <LPCaptionIcon id={id} icon={trailingIcon} attachments={attachments} position=\"right\" />\n        </div>\n    );\n}","import { AttachmentRepresentation, RichLinkImage } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { apiClient } from \"../../../../../../app/connection\";\nimport { LPRenderingContext } from \"../LPBalloon\";\n\nexport interface LPCaptionIconRenderingContext extends LPRenderingContext {\n    icon?: RichLinkImage;\n    position: \"left\" | \"right\";\n}\n\nfunction isSyntheticImage(icon: RichLinkImage): icon is RichLinkImage & { src: string } {\n    return icon.type === 99 && typeof (icon as Record<string, string>).src === \"string\";\n}\n\nfunction computeIconSrc(icon: RichLinkImage | undefined, attachments: AttachmentRepresentation[]) {\n    if (!icon) return null;\n    else if (isSyntheticImage(icon)) return icon.src;\n    else if (typeof icon.attachmentIndex === \"undefined\" || !attachments[icon.attachmentIndex]) return null;\n    else return apiClient.attachmentURL(attachments[icon.attachmentIndex].id);\n}\n\nexport default function LPCaptionIcon({ icon, attachments, position }: LPCaptionIconRenderingContext) {\n    const src = computeIconSrc(icon, attachments);\n    if (!src) return null;\n\n    return (\n        <img alt=\"Site Icon\" className={`lp-caption-icon lp-caption-icon-${position}`} src={src} />\n    );\n}","import { RichLinkCaptionSection } from \"imcore-ajax-core\";\nimport React, { PropsWithoutRef } from \"react\";\n\nexport interface LPCaptionSectionRenderingContext {\n    section?: RichLinkCaptionSection;\n    position: \"top\" | \"aboveTop\" | \"bottom\" | \"belowBottom\";\n}\n\nexport default function LPCaptionSection({ section, position }: PropsWithoutRef<LPCaptionSectionRenderingContext>) {\n    if (!section?.leading && !section?.trailing) return null;\n\n    return (\n        <div className={`lp-caption-section lp-caption-section-${position}`}>\n            {\n                section.leading ? <div className=\"lp-leading-text\">{ section.leading.text }</div> : null\n            }\n            {\n                section.trailing ? <div className=\"lp-trailing-text\">{ section.trailing.text }</div> : null\n            }\n        </div>\n    );\n}","import { AttachmentRepresentation, RichLinkAsset, RichLinkAudio, RichLinkCaptionBar, RichLinkImage, RichLinkVideo } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { apiClient } from \"../../../../../../app/connection\";\nimport { LPRenderingContext } from \"../LPBalloon\";\nimport LPAssetRenderer from \"./LPAssetRenderer\";\nimport LPCaptionBar from \"./LPCaptionBar\";\n\ninterface LPMediaRenderingContext extends LPRenderingContext {\n    video?: RichLinkVideo;\n    image?: RichLinkImage;\n    audio?: RichLinkAudio;\n    topCaptionBar?: RichLinkCaptionBar;\n    bottomCaptionBar?: RichLinkCaptionBar;\n    changed: () => any;\n}\n\nfunction attachmentURL(asset: RichLinkAsset | undefined, attachments: AttachmentRepresentation[]) {\n    if (!asset) return null;\n    if (typeof asset.attachmentIndex !== \"number\") return null;\n    if (!attachments[asset.attachmentIndex]) return null;\n    return apiClient.attachmentURL(attachments[asset.attachmentIndex].id);\n}\n\nexport default function LPMedia(ctx: LPMediaRenderingContext) {\n    const videoURL = ctx.video?.streamingURL || ctx.video?.youTubeURL || attachmentURL(ctx.video, ctx.attachments);\n    const imageURL = attachmentURL(ctx.image, ctx.attachments);\n\n    if (!videoURL && !imageURL) return null;\n\n    return (\n        <div className=\"lp-media\">\n            {\n                ctx.topCaptionBar ? (\n                    <LPCaptionBar id={ctx.id} captionBar={ctx.topCaptionBar} attachments={ctx.attachments} />\n                ) : null\n            }\n            <LPAssetRenderer imageURL={imageURL} videoURL={videoURL} id={ctx.id} changed={ctx.changed} />\n            {\n                ctx.bottomCaptionBar ? (\n                    <LPCaptionBar id={ctx.id} captionBar={ctx.bottomCaptionBar} attachments={ctx.attachments} />\n                ) : null\n            }\n        </div>\n    );\n}","import React from \"react\";\nimport { IMItemRenderingContext } from \"../Message\";\n\nexport default function IMDateSeparatorItem({ message }: IMItemRenderingContext) {\n    return (\n        <></>\n    );\n}","import { GroupTitleChangeItemRepresentation } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { useFormattedHandle } from \"../../../../hooks/useFormattedHandles\";\nimport { IMItemRenderingContext } from \"../Message\";\n\nexport type IMGroupTitleTranscriptItemRenderingContext = IMItemRenderingContext<GroupTitleChangeItemRepresentation>;\n\nexport default function IMGroupTitleChangeItem({ item, message }: IMGroupTitleTranscriptItemRenderingContext) {\n    const formattedSender = useFormattedHandle(item.sender);\n\n    return <div className=\"transcript-label\">{formattedSender} <span className=\"transcript-label-value\">named the conversation \"{item.title}\".</span></div>;\n}","import { ParticipantChangeTranscriptChatItemRepresentation } from \"imcore-ajax-core\";\nimport React from \"react\";\nimport { useFormattedHandle } from \"../../../../hooks/useFormattedHandles\";\nimport { IMItemRenderingContext } from \"../Message\";\n\nexport type IMParticipantChangeItemRenderingContext = IMItemRenderingContext<ParticipantChangeTranscriptChatItemRepresentation>;\n\nexport default function IMParticipantChangeItem({ item }: IMParticipantChangeItemRenderingContext) {\n    const formattedInitiator = useFormattedHandle(item.initiatorID);\n    const formattedTarget = useFormattedHandle(item.targetID);\n\n    return (\n        <div className=\"transcript-label\">\n            {formattedInitiator} <span className=\"transcript-label-value\">{item.changeType ? \"removed\" : \"added\"} {formattedTarget} from the conversation.</span>\n        </div>\n    );\n}","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport React, { createContext, PropsWithChildren, useCallback, useMemo, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectChats } from \"../app/reducers/chats\";\nimport { selectHandleIDToContact } from \"../app/reducers/contacts\";\n\nexport interface ChatSearchContextData {\n    searchCriteria?: string;\n    chatResults: ChatRepresentation[];\n    setSearchCriteria: (criteria: string) => void;\n    clearSearchCriteria: () => void;\n}\n\nexport const ChatSearchContext = createContext<ChatSearchContextData>({\n    chatResults: [],\n    setSearchCriteria: () => undefined,\n    clearSearchCriteria: () => undefined\n});\n\nexport function ChatSearchProvider({ children }: PropsWithChildren<{}>) {\n    const allChats = Object.values(useSelector(selectChats));\n    const contacts = useSelector(selectHandleIDToContact);\n\n    const [ searchCriteria, setSearchCriteria ] = useState<string>();\n\n    const chatResults = useMemo(() => !searchCriteria ? allChats : allChats.filter(chat => {\n        return [chat.displayName, chat.id, chat.lastMessage, chat.participants, chat.participants.map(participant => contacts[participant]?.fullName)].flat().some(text => text?.toLowerCase().includes(searchCriteria));\n    }), [allChats, searchCriteria]);\n\n    const clearSearchCriteria = useCallback(() => {\n\n    }, []);\n\n    return (\n        <ChatSearchContext.Provider value={{\n            searchCriteria,\n            chatResults: chatResults ? chatResults : allChats,\n            setSearchCriteria,\n            clearSearchCriteria\n        }}>\n            {children}\n        </ChatSearchContext.Provider>\n    );\n}","import { ChatRepresentation } from \"imcore-ajax-core\";\nimport { useSelector } from \"react-redux\";\nimport { selectHandleIDToContact } from \"../app/reducers/contacts\";\nimport { extractFormattedHandles } from \"./useFormattedHandles\";\n\nexport default function useChatName(chat?: ChatRepresentation | null): string | null {\n    const handleIDToContact = useSelector(selectHandleIDToContact);\n\n    if (!chat) return null;\n\n    return chat.displayName || extractFormattedHandles(chat.participants, handleIDToContact).join(\", \") || chat.id;\n}","import { ContactRepresentation } from \"imcore-ajax-core\";\nimport { useEffect, useState } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { selectHandleIDToContact } from \"../app/reducers/contacts\";\n\nexport function useContactResolver(handleIDs: string[]): Array<ContactRepresentation | null> {\n    const [resolved, setResolved] = useState([] as Array<ContactRepresentation | null>);\n    const handleIDToContact = useSelector(selectHandleIDToContact);\n\n    useEffect(() => {\n        setResolved(handleIDs.map(handleID => handleIDToContact[handleID] || null));\n    }, [handleIDs, handleIDToContact]);\n\n    return resolved;\n}","import { EventEmitter, EventListener } from \"eventemitter3\";\nimport { useEffect } from \"react\";\n\nexport interface EventTypes {\n    resetDynamicSizeList: [];\n    dumpDSLMeasurements: [];\n    dumpDSLListRef: [];\n    dslRescroll: [];\n}\n\nexport const EventBus = new EventEmitter<EventTypes>();\n\nexport function useEvent<T extends keyof EventTypes>(event: T, fn: EventListener<EventTypes, T>) {\n    useEffect(() => {\n        EventBus.on(event, fn);\n\n        return () => {\n            EventBus.off(event, fn);\n        };\n    });\n}","import { ContactRepresentation } from \"imcore-ajax-core\";\nimport parsePhoneNumber from \"libphonenumber-js\";\nimport { useSelector } from \"react-redux\";\nimport { selectHandleIDToContact } from \"../app/reducers/contacts\";\n\nconst cache: Record<string, string> = {};\n\nexport function formatPhoneNumber(rawPhoneNumber: string): string {\n    try {\n        if (cache[rawPhoneNumber]) return cache[rawPhoneNumber];\n\n        const phoneNumber = parsePhoneNumber(rawPhoneNumber);\n        if (!phoneNumber) return rawPhoneNumber;\n        else return cache[rawPhoneNumber] = `+${phoneNumber.countryCallingCode} ${phoneNumber.formatNational()}`;\n    } catch {\n        return rawPhoneNumber;\n    }\n}\n\nexport function extractFormattedHandles(handleIDs: string[], contacts: Record<string, ContactRepresentation>): string[] {\n    return handleIDs.map(handleID => {\n        const contact = contacts[handleID];\n        if (contact) return contact.fullName || handleID;\n        else return formatPhoneNumber(handleID);\n    });\n}\n\nexport function useFormattedHandles(handleIDs: string[]): string[] {\n    const handleIDToContact = useSelector(selectHandleIDToContact);\n    \n    return extractFormattedHandles(handleIDs, handleIDToContact);\n}\n\nexport function useFormattedHandle(handleID: string | undefined): string {\n    const handleIDToContact = useSelector(selectHandleIDToContact);\n\n    if (!handleID) return \"You\";\n    else {\n        const contact = handleIDToContact[handleID];\n        if (contact) return contact.fullName || handleID;\n        else return formatPhoneNumber(handleID);\n    }\n}","// extracted by mini-css-extract-plugin","import React from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport { Provider } from \"react-redux\";\r\nimport { BrowserRouter as Router } from \"react-router-dom\";\r\nimport App from \"./App\";\r\nimport { visibilityChanged } from \"./app/reducers/presence\";\r\nimport { store } from \"./app/store\";\r\nimport { CurrentChatProvider } from \"./components/transcript/ChatTranscriptFoundation\";\r\nimport \"./index.css\";\r\n\r\nReactDOM.render(\r\n  <Provider store={store}>\r\n    <Router>\r\n      <CurrentChatProvider>\r\n        <App />\r\n      </CurrentChatProvider>\r\n    </Router>\r\n  </Provider>,\r\n  document.getElementById(\"root\")\r\n);\r\n\r\ndocument.addEventListener(\"visibilitychange\", () => store.dispatch(visibilityChanged()));","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","// extracted by mini-css-extract-plugin","export function findAncestor(element: HTMLElement, cb: (parent: HTMLElement) => boolean): HTMLElement | null {\n    if (cb(element)) return element;\n    else if (element.parentElement) return findAncestor(element.parentElement, cb);\n    else return null;\n}","import { ConsoleFormattedStream, createLogger, resolveLevel } from \"browser-bunyan\";\n\nconst sharedStream = new ConsoleFormattedStream();\n\ntype Logger = ReturnType<typeof createLogger>\n\ninterface IMLogger extends Logger {\n    maybeDebug(cb: () => any[]): void;\n}\n\nfunction makeMaybeLogger(logger: Logger, configLevel: number, requiredLevel: number) {\n    if (configLevel > requiredLevel) return (cb: () => any[]) => undefined;\n    else return (cb: () => any[]) => (logger.debug as any)(...cb());\n}\n\nexport default function IMMakeLog(namespace: string, level: string | number | undefined = \"debug\"): IMLogger {\n    const logger = createLogger({\n        name: namespace,\n        stream: sharedStream,\n        level\n    });\n\n    const resolvedLevel = resolveLevel(level);\n\n    return Object.assign(logger, {\n        maybeDebug: makeMaybeLogger(logger, resolvedLevel, resolveLevel(\"debug\"))\n    });\n}\n\nexport const IMLog = IMMakeLog(\"IMCore\");","import { AnyChatItemModel, MessageRepresentation } from \"imcore-ajax-core\";\nimport { DATE_SEPARATOR_TYPE } from \"../components/transcript/items/IMTranscriptItem\";\nimport { messageIsEmpty } from \"../components/transcript/items/Message\";\n\nexport function messagesAreCloseEnough(message1: MessageRepresentation, message2: MessageRepresentation): boolean {\n    return Math.abs(message1.time - message2.time) < (1000 * 60 * 60);\n}\n\nexport const TIMESTAMP_ASSOCIATION: keyof MessageRepresentation = Symbol(\"TIMESTAMP_ASSOCIATION\") as unknown as keyof MessageRepresentation;\n\nexport function createTimestampMessage({ service, time, chatID, id }: MessageRepresentation): MessageRepresentation {\n    return {\n        service,\n        time,\n        timeDelivered: 0,\n        timePlayed: 0,\n        timeRead: 0,\n        isSOS: false,\n        isAudioMessage: false,\n        isCancelTypingMessage: false,\n        isDelivered: false,\n        isTypingMessage: false,\n        items: [\n            {\n                type: DATE_SEPARATOR_TYPE,\n                payload: {\n                    id: \"\",\n                    chatID,\n                    fromMe: false,\n                    time\n                }\n            } as unknown as AnyChatItemModel\n        ],\n        fileTransferIDs: [],\n        chatID,\n        id: `${id}--timesep`,\n        flags: 0,\n        fromMe: false,\n        [TIMESTAMP_ASSOCIATION]: id\n    };\n}\n\nexport function prepareMessagesForPresentation(messages: Record<string, MessageRepresentation>, reverse: boolean, injectTimestamps: boolean): MessageRepresentation[] {\n    const preparedMessages: MessageRepresentation[] = [];\n\n    for (const messageID in messages) {\n        if (messageIsEmpty(messages[messageID])) continue;\n        preparedMessages.push(messages[messageID]);\n    }\n\n    preparedMessages.sort((m1, m2) => {\n        if (m1.isTypingMessage) return 1;\n        else if (m2.isTypingMessage) return -1;\n\n        return m1.time - m2.time;\n    });\n\n    if (injectTimestamps) {\n        for (let i = 0; i < preparedMessages.length; i++) {\n            const message = preparedMessages[i];\n\n            if (message.isTypingMessage || message[TIMESTAMP_ASSOCIATION]) continue;\n\n            const prevMessage = preparedMessages[i - 1];\n\n            if (prevMessage && messagesAreCloseEnough(prevMessage, message)) continue;\n\n            preparedMessages.splice(i, 0, createTimestampMessage(message));\n        }\n    }\n\n    if (reverse) preparedMessages.reverse();\n\n    return preparedMessages;\n}\n","import { DateTime } from \"luxon\";\nimport { useLayoutEffect, useState } from \"react\";\n\nexport function useFormattedReceipt(millis: number | null) {\n    const [formattedReceipt, setFormattedReceipt] = useState(null as string | null);\n\n    useLayoutEffect(() => {\n        if (millis === null) {\n            setFormattedReceipt(null);\n            return;\n        }\n\n        const parsed = DateTime.fromMillis(millis);\n        if (parsed.hasSame(DateTime.local(), \"day\")) {\n            setFormattedReceipt(parsed.toLocaleString(DateTime.TIME_SIMPLE));\n        } else if (parsed.hasSame(DateTime.local().minus({ day: 1 }), \"day\")) {\n            setFormattedReceipt(parsed.toRelativeCalendar());\n        } else {\n            setFormattedReceipt(parsed.toLocaleString(DateTime.DATE_SHORT));\n        }\n    }, [millis]);\n\n    return formattedReceipt;\n}\n\nexport function useFormattedTimestamp(millis: number | null) {\n    const [formattedTimestamp, setFormattedTimestamp] = useState(null as { date: string; time: string; } | null);\n\n    useLayoutEffect(() => {\n        if (millis === null) {\n            setFormattedTimestamp(null);\n            return;\n        }\n\n        const parsed = DateTime.fromMillis(millis);\n\n        const now = DateTime.local();\n\n        let date: string;\n\n        if (parsed.hasSame(now, \"day\") || parsed.hasSame(now.minus({ day: 1 }), \"day\")) {\n            date = parsed.toRelativeCalendar() || parsed.toLocaleString(DateTime.DATE_SHORT);\n            date = date.replace(date[0], date[0].toUpperCase());\n        } else {\n            date = parsed.toLocaleString(DateTime.DATE_SHORT);\n        }\n\n        setFormattedTimestamp({\n            date,\n            time: parsed.toLocaleString(DateTime.TIME_SIMPLE)\n        });\n    }, [millis]);\n\n    return formattedTimestamp;\n}","import { useEffect, useMemo, useRef, useState } from \"react\";\n\nconst persistentCache: Map<string, VersionedValue<any>> = new Map();\n\ninterface VersionedValue<T> {\n    value: T;\n    revision: number;\n    observe: (cb: (newValue: T) => any) => () => void;\n}\n\nconst persistentObservers: Map<string, Set<(newValue: any) => void>> = new Map();\n\nfunction read<T>(key: string, defaultValue: T): T {\n    const value = localStorage.getItem(key);\n    if (!value) return defaultValue;\n\n    try {\n        return JSON.parse(value);\n    } catch {\n        return defaultValue;\n    }\n}\n\nconst versionedValueFactory = <T>(key: string, defaultValue: T) => new Proxy({\n    value: read(key, defaultValue),\n    revision: 0,\n    observe: (cb: (newValue: T) => any) => observePersistent(key, cb)\n}, {\n    set(target, property, value) {\n        switch (property) {\n            case \"value\":\n                localStorage.setItem(key, JSON.stringify(value));\n                target.value = value;\n                target.revision += 1;\n\n                if (!persistentObservers.has(key)) break;\n    \n                for (const observer of persistentObservers.get(key)!) {\n                    observer(value);\n                }\n\n                break;\n            case \"revision\":\n                throw new Error(\"Revision cannot be mutated externally.\");\n        }\n\n        return true;\n    }\n});\n\nexport function getPersistentValue<T>(key: string, defaultValue: T): VersionedValue<T> {\n    if (persistentCache.has(key)) return persistentCache.get(key) as VersionedValue<T>;\n    else return persistentCache.set(key, versionedValueFactory(key, defaultValue)).get(key) as VersionedValue<T>;\n}\n\nfunction observePersistent<T>(key: string, fn: (newValue: T) => void): () => void {\n    if (!persistentObservers.has(key)) persistentObservers.set(key, new Set());\n    persistentObservers.get(key)!.add(fn);\n\n    return () => {\n        persistentObservers.get(key)?.delete(fn);\n    };\n}\n\nexport function usePersistent<T = any>(key: string, defaultValue: T): [T, (newValue: T) => void] {\n    const [persistentValue, setPersistentValue] = useState(null! as T);\n    const revision = useRef(-1);\n    const latest = useMemo(() => getPersistentValue(key, defaultValue), []);\n\n    if (revision.current !== latest.revision) {\n        setPersistentValue(latest.value);\n        revision.current = latest.revision;\n    }\n\n    useEffect(() => latest.observe(newValue => {\n        setPersistentValue(newValue);\n    }));\n\n    return [persistentValue, newValue => {\n        getPersistentValue(key, newValue).value = newValue;\n    }];\n}"],"sourceRoot":""}